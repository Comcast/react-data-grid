import{j as p,r as g,c as le,u as de,f as D}from"./index-CwZuUZ-y.js";import{u as ce,g as ue,a as ae,S as F,b as fe,d as pe,c as ge,r as he,e as xe,f as me,h as ye,i as Ce,j as P,D as Re,k as Se,l as ke}from"./DataGrid-gkQRtDvm.js";const Ge="g1s9ylgp",be=`rdg-group-cell-content ${Ge}`,we="cz54e4y",ve=`rdg-caret ${we}`;function je(s){return p.jsx(Ie,{...s})}function Ie({groupKey:s,isExpanded:t,tabIndex:i,toggleGroup:c}){function h({key:x}){x==="Enter"&&c()}const u=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return p.jsxs("span",{className:be,tabIndex:i,onKeyDown:h,children:[s,p.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:ve,"aria-hidden":!0,children:p.jsx("path",{d:u})})]})}function De({id:s,groupKey:t,childRows:i,isExpanded:c,isCellSelected:h,column:u,row:x,groupColumnIndex:k,isGroupByColumn:G,toggleGroup:d}){const{tabIndex:b,childTabIndex:C,onFocus:w}=ce(h);function m(){d(s)}const j=G&&k===u.idx;return p.jsx("div",{role:"gridcell","aria-colindex":u.idx+1,"aria-selected":h,tabIndex:b,className:ae(u),style:{...ue(u),cursor:j?"pointer":"default"},onClick:j?m:void 0,onFocus:w,children:(!G||j)&&u.renderGroupCell?.({groupKey:t,childRows:i,column:u,row:x,isExpanded:c,tabIndex:C,toggleGroup:m})},u.key)}const Ee=g.memo(De),Ae="g1yxluv3",Oe=`rdg-group-row ${Ae}`;function ze({className:s,row:t,rowIdx:i,viewportColumns:c,selectedCellIdx:h,isRowSelected:u,selectCell:x,gridRowStart:k,groupBy:G,toggleGroup:d,isRowSelectionDisabled:b,...C}){const w=c[0].key===F?t.level+1:t.level;function m(){x({rowIdx:i,idx:-1})}const j=g.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:u}),[u]);return p.jsx(fe,{value:j,children:p.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:ge(he,Oe,`rdg-row-${i%2===0?"even":"odd"}`,h===-1&&xe,s),onClick:m,style:pe(k),...C,children:c.map(E=>p.jsx(Ee,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:h===E.idx,column:E,row:t,groupColumnIndex:w,toggleGroup:d,isGroupByColumn:G.includes(E.key)},E.key))})})}const Te=g.memo(ze);function Le({columns:s,rows:t,rowHeight:i,rowKeyGetter:c,onCellKeyDown:h,onRowsChange:u,selectedRows:x,onSelectedRowsChange:k,renderers:G,groupBy:d,rowGrouper:b,expandedGroupIds:C,onExpandedGroupIdsChange:w,...m}){const j=me(),E=G?.renderRow??j?.renderRow??ye,U=1+(m.topSummaryRows?.length??0),V=m.direction==="rtl",Y=V?"ArrowRight":"ArrowLeft",X=V?"ArrowLeft":"ArrowRight",Z=Ce(J),{columns:H,groupBy:T}=g.useMemo(()=>{const n=[...s].sort(({key:r},{key:o})=>r===F?-1:o===F?1:d.includes(r)?d.includes(o)?d.indexOf(r)-d.indexOf(o):-1:d.includes(o)?1:0),e=[];for(const[r,o]of n.entries())d.includes(o.key)&&(e.push(o.key),n[r]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??je,editable:!1});return{columns:n,groupBy:e}},[s,d]),[W,K]=g.useMemo(()=>{if(T.length===0)return[void 0,t.length];const n=(e,[r,...o],l)=>{let f=0;const a={};for(const[S,v]of Object.entries(b(e,r))){const[O,I]=o.length===0?[v,v.length]:n(v,o,l+f+1);a[S]={childRows:v,childGroups:O,startRowIndex:l+f},f+=I+1}return[a,f]};return n(t,T,0)},[T,b,t]),[R,y]=g.useMemo(()=>{const n=new Set;if(!W)return[t,o];const e=[],r=(l,f,a)=>{if(Me(l)){e.push(...l);return}Object.keys(l).forEach((S,v,O)=>{const I=f!==void 0?`${f}__${S}`:S,M=C.has(I),{childRows:z,childGroups:N,startRowIndex:$}=l[S],A={id:I,parentId:f,groupKey:S,isExpanded:M,childRows:z,level:a,posInSet:v,startRowIndex:$,setSize:O.length};e.push(A),n.add(A),M&&r(N,I,a+1)})};return r(W,void 0,0),[e,o];function o(l){return n.has(l)}},[C,W,t]),ee=g.useMemo(()=>typeof i=="function"?n=>y(n)?i({type:"GROUP",row:n}):i({type:"ROW",row:n}):i,[y,i]),L=g.useCallback(n=>{const e=R.indexOf(n);for(let r=e-1;r>=0;r--){const o=R[r];if(y(o)&&(!y(n)||n.parentId===o.id))return[o,r]}},[y,R]),q=g.useCallback(n=>{if(y(n))return n.id;if(typeof c=="function")return c(n);const e=L(n);if(e!==void 0){const{startRowIndex:r,childRows:o}=e[0],l=o.indexOf(n);return r+l+1}return R.indexOf(n)},[L,y,c,R]),_=g.useMemo(()=>{if(x==null)return null;P(c);const n=new Set(x);for(const e of R)y(e)&&e.childRows.every(o=>x.has(c(o)))&&n.add(e.id);return n},[y,c,x,R]);function ne(n){if(!k)return;P(c);const e=new Set(x);for(const r of R){const o=q(r);if(_?.has(o)&&!n.has(o))if(y(r))for(const l of r.childRows)e.delete(c(l));else e.delete(o);else if(!_?.has(o)&&n.has(o))if(y(r))for(const l of r.childRows)e.add(c(l));else e.add(o)}k(e)}function te(n,e){if(h?.(n,e),e.isGridDefaultPrevented()||n.mode==="EDIT")return;const{column:r,rowIdx:o,selectCell:l}=n,f=r?.idx??-1,a=R[o];if(y(a)){if(f===-1&&(e.key===Y&&a.isExpanded||e.key===X&&!a.isExpanded)&&(e.preventDefault(),e.preventGridDefault(),J(a.id)),f===-1&&e.key===Y&&!a.isExpanded&&a.level!==0){const S=L(a);S!==void 0&&(e.preventGridDefault(),l({idx:f,rowIdx:S[1]}))}Se(e)&&(e.keyCode===67||e.keyCode===86)&&e.preventGridDefault()}}function oe(n,{indexes:e,column:r}){if(!u)return;const o=[...t],l=[];for(const f of e){const a=t.indexOf(R[f]);o[a]=n[f],l.push(a)}u(o,{indexes:l,column:r})}function J(n){const e=new Set(C);e.has(n)?e.delete(n):e.add(n),w(e)}function se(n,{row:e,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:f,onRowChange:a,lastFrozenColumnIndex:S,copiedCellIdx:v,draggedOverCellIdx:O,setDraggedOverRowIdx:I,selectedCellEditor:M,...z}){if(y(e)){const{startRowIndex:A}=e;return p.jsx(Te,{...z,"aria-rowindex":U+A+1,row:e,groupBy:T,toggleGroup:Z},n)}let N=z["aria-rowindex"];const $=L(e);if($!==void 0){const{startRowIndex:A,childRows:re}=$[0],ie=re.indexOf(e);N=A+U+ie+2}return E(n,{...z,"aria-rowindex":N,row:e,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:f,onRowChange:a,lastFrozenColumnIndex:S,copiedCellIdx:v,draggedOverCellIdx:O,setDraggedOverRowIdx:I,selectedCellEditor:M})}return p.jsx(Re,{...m,role:"treegrid","aria-rowcount":K+1+(m.topSummaryRows?.length??0)+(m.bottomSummaryRows?.length??0),columns:H,rows:R,rowHeight:ee,rowKeyGetter:q,onRowsChange:oe,selectedRows:_,onSelectedRowsChange:ne,onCellKeyDown:te,renderers:{...G,renderRow:se}})}function Me(s){return Array.isArray(s)}const qe=le("/RowGrouping")({component:Fe}),Ne="gdm23ek",$e="orv6f2f",Q=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],We=[ke,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:s}){return s.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:s}){return s.gold+s.silver+s.bronze},renderGroupCell({childRows:s}){return s.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function _e(s){return s.id}function Be(){const s=[];for(let t=1;t<1e4;t++)s.push({id:t,year:2015+D.number.int(3),country:D.location.country(),sport:Q[D.number.int(Q.length-1)],athlete:D.person.fullName(),gold:D.number.int(5),silver:D.number.int(5),bronze:D.number.int(5)});return s.sort((t,i)=>i.country.localeCompare(t.country))}const B=["country","year","sport","athlete"];function Fe(){const s=de(),[t]=g.useState(Be),[i,c]=g.useState(()=>new Set),[h,u]=g.useState([B[0],B[1]]),[x,k]=g.useState(()=>new Set(["United States of America","United States of America__2015"]));function G(d,b){const C=h.indexOf(d);b?C===-1&&u(w=>[...w,d]):C!==-1&&u(w=>{const m=[...w];return m.splice(C,1),m}),k(new Set)}return p.jsxs("div",{className:Ne,children:[p.jsx("b",{children:"Group by columns:"}),p.jsx("div",{className:$e,children:B.map(d=>p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:h.includes(d),onChange:b=>G(d,b.target.checked)})," ",d]},d))}),p.jsx(Le,{columns:We,rows:t,rowKeyGetter:_e,selectedRows:i,onSelectedRowsChange:c,groupBy:h,rowGrouper:Ue,expandedGroupIds:x,onExpandedGroupIdsChange:k,defaultColumnOptions:{resizable:!0},direction:s})]})}function Ue(s,t){return Object.groupBy(s,i=>i[t])}export{qe as Route};
//# sourceMappingURL=RowGrouping.lazy-xSduUlH7.js.map
