import{j as f,r as h,u as ce,f as O}from"./index-DKImFYtI.js";import{u as ue,g as ae,a as fe,S as U,b as pe,d as ge,c as he,r as xe,e as me,f as Ce,h as ye,i as Re,j as Se,k as q,D as ke,l as be}from"./DataGrid-DuzarnYy.js";const Ge="g1s9ylgp",ve=`rdg-group-cell-content ${Ge}`,je="cz54e4y",Ie=`rdg-caret ${je}`;function Ee(r){return f.jsx(De,{...r})}function De({groupKey:r,isExpanded:t,tabIndex:i,toggleGroup:d}){function y({key:R}){R==="Enter"&&d()}const c=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return f.jsxs("span",{className:ve,tabIndex:i,onKeyDown:y,children:[r,f.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:Ie,"aria-hidden":!0,children:f.jsx("path",{d:c})})]})}function Oe({id:r,groupKey:t,childRows:i,isExpanded:d,isCellSelected:y,column:c,row:R,groupColumnIndex:j,isGroupByColumn:x,toggleGroup:I}){const{tabIndex:m,childTabIndex:p,onFocus:b}=ue(y);function C(){I(r)}const G=x&&j===c.idx;return f.jsx("div",{role:"gridcell","aria-colindex":c.idx+1,"aria-selected":y,tabIndex:m,className:fe(c),style:{...ae(c),cursor:G?"pointer":"default"},onClick:G?C:void 0,onFocus:b,children:(!x||G)&&c.renderGroupCell?.({groupKey:t,childRows:i,column:c,row:R,isExpanded:d,tabIndex:p,toggleGroup:C})},c.key)}const we=h.memo(Oe),Ae="g1yxluv3",ze=`rdg-group-row ${Ae}`;function Te({className:r,row:t,rowIdx:i,viewportColumns:d,selectedCellIdx:y,isRowSelected:c,selectCell:R,gridRowStart:j,groupBy:x,toggleGroup:I,isRowSelectionDisabled:m,...p}){const b=d[0].key===U?t.level+1:t.level;function C(){R({rowIdx:i,idx:-1})}const G=h.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:c}),[c]);return f.jsx(pe,{value:G,children:f.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:he(xe,ze,`rdg-row-${i%2===0?"even":"odd"}`,y===-1&&me,r),onClick:C,style:ge(j),...p,children:d.map(v=>f.jsx(we,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:y===v.idx,column:v,row:t,groupColumnIndex:b,toggleGroup:I,isGroupByColumn:x.includes(v.key)},v.key))})})}const Le=h.memo(Te);function Me({columns:r,rows:t,rowHeight:i,rowKeyGetter:d,onCellKeyDown:y,onCellCopy:c,onCellPaste:R,onRowsChange:j,selectedRows:x,onSelectedRowsChange:I,renderers:m,groupBy:p,rowGrouper:b,expandedGroupIds:C,onExpandedGroupIdsChange:G,...v}){const Q=Ce(),X=m?.renderRow??Q?.renderRow??ye,F=1+(v.topSummaryRows?.length??0),{leftKey:P,rightKey:Z}=Re(v.direction),H=Se(Y),{columns:K,groupBy:T}=h.useMemo(()=>{const e=[...r].sort(({key:s},{key:o})=>s===U?-1:o===U?1:p.includes(s)?p.includes(o)?p.indexOf(s)-p.indexOf(o):-1:p.includes(o)?1:0),n=[];for(const[s,o]of e.entries())p.includes(o.key)&&(n.push(o.key),e[s]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??Ee,editable:!1});return{columns:e,groupBy:n}},[r,p]),[W,ee]=h.useMemo(()=>{if(T.length===0)return[void 0,t.length];const e=(n,[s,...o],l)=>{let a=0;const u={};for(const[k,E]of Object.entries(b(n,s))){const[A,D]=o.length===0?[E,E.length]:e(E,o,l+a+1);u[k]={childRows:E,childGroups:A,startRowIndex:l+a},a+=D+1}return[u,a]};return e(t,T,0)},[T,b,t]),[S,g]=h.useMemo(()=>{const e=new Set;if(!W)return[t,o];const n=[],s=(l,a,u)=>{if(Ne(l)){n.push(...l);return}Object.keys(l).forEach((k,E,A)=>{const D=a!==void 0?`${a}__${k}`:k,w=C.has(D),{childRows:M,childGroups:N,startRowIndex:z}=l[k],$={id:D,parentId:a,groupKey:k,isExpanded:w,childRows:M,level:u,posInSet:E,startRowIndex:z,setSize:A.length};n.push($),e.add($),w&&s(N,D,u+1)})};return s(W,void 0,0),[n,o];function o(l){return e.has(l)}},[C,W,t]),ne=h.useMemo(()=>typeof i=="function"?e=>g(e)?i({type:"GROUP",row:e}):i({type:"ROW",row:e}):i,[g,i]),L=h.useCallback(e=>{const n=S.indexOf(e);for(let s=n-1;s>=0;s--){const o=S[s];if(g(o)&&(!g(e)||e.parentId===o.id))return[o,s]}},[g,S]),V=h.useCallback(e=>{if(g(e))return e.id;if(typeof d=="function")return d(e);const n=L(e);if(n!==void 0){const{startRowIndex:s,childRows:o}=n[0],l=o.indexOf(e);return s+l+1}return S.indexOf(e)},[L,g,d,S]),_=h.useMemo(()=>{if(x==null)return null;q(d);const e=new Set(x);for(const n of S)g(n)&&n.childRows.every(o=>x.has(d(o)))&&e.add(n.id);return e},[g,d,x,S]);function te(e){if(!I)return;q(d);const n=new Set(x);for(const s of S){const o=V(s);if(_?.has(o)&&!e.has(o))if(g(s))for(const l of s.childRows)n.delete(d(l));else n.delete(o);else if(!_?.has(o)&&e.has(o))if(g(s))for(const l of s.childRows)n.add(d(l));else n.add(o)}I(n)}function oe(e,n){if(y?.(e,n),n.isGridDefaultPrevented()||e.mode==="EDIT")return;const{column:s,rowIdx:o,selectCell:l}=e,a=s?.idx??-1,u=S[o];if(g(u)&&(a===-1&&(n.key===P&&u.isExpanded||n.key===Z&&!u.isExpanded)&&(n.preventDefault(),n.preventGridDefault(),Y(u.id)),a===-1&&n.key===P&&!u.isExpanded&&u.level!==0)){const k=L(u);k!==void 0&&(n.preventGridDefault(),l({idx:a,rowIdx:k[1]}))}}function se({row:e,column:n},s){g(e)||c?.({row:e,column:n},s)}function re({row:e,column:n},s){return g(e)?e:R({row:e,column:n},s)}function ie(e,{indexes:n,column:s}){if(!j)return;const o=[...t],l=[];for(const a of n){const u=t.indexOf(S[a]);o[u]=e[a],l.push(u)}j(o,{indexes:l,column:s})}function Y(e){const n=new Set(C);n.has(e)?n.delete(e):n.add(e),G(n)}function le(e,{row:n,rowClass:s,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,draggedOverCellIdx:E,setDraggedOverRowIdx:A,selectedCellEditor:D,...w}){if(g(n)){const{startRowIndex:z}=n;return f.jsx(Le,{...w,"aria-rowindex":F+z+1,row:n,groupBy:T,toggleGroup:H},e)}let M=w["aria-rowindex"];const N=L(n);if(N!==void 0){const{startRowIndex:z,childRows:$}=N[0],de=$.indexOf(n);M=z+F+de+2}return X(e,{...w,"aria-rowindex":M,row:n,rowClass:s,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,draggedOverCellIdx:E,setDraggedOverRowIdx:A,selectedCellEditor:D})}return f.jsx(ke,{...v,role:"treegrid","aria-rowcount":ee+1+(v.topSummaryRows?.length??0)+(v.bottomSummaryRows?.length??0),columns:K,rows:S,rowHeight:ne,rowKeyGetter:V,onRowsChange:ie,selectedRows:_,onSelectedRowsChange:te,onCellKeyDown:oe,onCellCopy:se,onCellPaste:R?re:void 0,renderers:{...m,renderRow:le}})}function Ne(r){return Array.isArray(r)}const $e="g8apzrt",We="o12aimxb",J=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],_e=[be,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:r}){return r.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:r}){return r.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:r}){return r.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:r}){return r.gold+r.silver+r.bronze},renderGroupCell({childRows:r}){return r.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function Be(r){return r.id}function Ue(){const r=[];for(let t=1;t<1e4;t++)r.push({id:t,year:2015+O.number.int(3),country:O.location.country(),sport:J[O.number.int(J.length-1)],athlete:O.person.fullName(),gold:O.number.int(5),silver:O.number.int(5),bronze:O.number.int(5)});return r.sort((t,i)=>i.country.localeCompare(t.country))}const B=["country","year","sport","athlete"];function Fe(r,t){return Object.groupBy(r,i=>i[t])}const Ye=function(){const t=ce(),[i]=h.useState(Ue),[d,y]=h.useState(()=>new Set),[c,R]=h.useState([B[0],B[1]]),[j,x]=h.useState(()=>new Set(["United States of America","United States of America__2015"]));function I(m,p){const b=c.indexOf(m);p?b===-1&&R(C=>[...C,m]):b!==-1&&R(C=>{const G=[...C];return G.splice(b,1),G}),x(new Set)}return f.jsxs("div",{className:$e,children:[f.jsx("b",{children:"Group by columns:"}),f.jsx("div",{className:We,children:B.map(m=>f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:c.includes(m),onChange:p=>I(m,p.target.checked)})," ",m]},m))}),f.jsx(Me,{columns:_e,rows:i,rowKeyGetter:Be,selectedRows:d,onSelectedRowsChange:y,groupBy:c,rowGrouper:Fe,expandedGroupIds:j,onExpandedGroupIdsChange:x,defaultColumnOptions:{resizable:!0},direction:t})]})};export{Ye as component};
//# sourceMappingURL=RowGrouping-DjFd9Dt9.js.map
