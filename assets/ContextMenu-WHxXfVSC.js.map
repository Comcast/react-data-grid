{"version":3,"file":"ContextMenu-WHxXfVSC.js","names":["useLayoutEffect","useReducer","useRef","useState","createPortal","faker","css","DataGrid","Column","useDirection","Route","contextMenuClassname","Row","id","product","price","createRows","rows","i","push","commerce","productName","columns","key","name","rowKeyGetter","row","SplitComponent","ContextMenuDemo","direction","setRows","nextId","setNextId","length","contextMenuProps","setContextMenuProps","rowIdx","top","left","menuRef","HTMLMenuElement","isContextMenuOpen","onMouseDown","event","MouseEvent","target","Node","current","contains","addEventListener","removeEventListener","insertRow","insertRowIdx","newRow","toSpliced","preventGridDefault","preventDefault","indexOf","clientY","clientX","document","body","component"],"sources":["../../website/routes/ContextMenu.tsx?tsr-split=component"],"sourcesContent":["import { useLayoutEffect, useReducer, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { faker } from '@faker-js/faker';\nimport { css } from '@linaria/core';\n\nimport { DataGrid } from '../../src';\nimport type { Column } from '../../src';\nimport { useDirection } from '../directionContext';\n\nexport const Route = createFileRoute({\n  component: ContextMenuDemo\n});\n\nconst contextMenuClassname = css`\n  position: absolute;\n  background-color: #ffffff;\n  border: 1px solid black;\n  padding: 16px;\n  list-style: none;\n\n  > li {\n    padding: 8px;\n  }\n`;\n\ninterface Row {\n  id: number;\n  product: string;\n  price: string;\n}\n\nfunction createRows(): readonly Row[] {\n  const rows: Row[] = [];\n\n  for (let i = 1; i < 1000; i++) {\n    rows.push({\n      id: i,\n      product: faker.commerce.productName(),\n      price: faker.commerce.price()\n    });\n  }\n\n  return rows;\n}\n\nconst columns: readonly Column<Row>[] = [\n  { key: 'id', name: 'ID' },\n  { key: 'product', name: 'Product' },\n  { key: 'price', name: 'Price' }\n];\n\nfunction rowKeyGetter(row: Row) {\n  return row.id;\n}\n\nfunction ContextMenuDemo() {\n  const direction = useDirection();\n  const [rows, setRows] = useState(createRows);\n  const [nextId, setNextId] = useReducer((id: number) => id + 1, rows[rows.length - 1].id + 1);\n  const [contextMenuProps, setContextMenuProps] = useState<{\n    rowIdx: number;\n    top: number;\n    left: number;\n  } | null>(null);\n  const menuRef = useRef<HTMLMenuElement>(null);\n  const isContextMenuOpen = contextMenuProps !== null;\n\n  useLayoutEffect(() => {\n    if (!isContextMenuOpen) return;\n\n    function onMouseDown(event: MouseEvent) {\n      if (event.target instanceof Node && menuRef.current?.contains(event.target)) {\n        return;\n      }\n      setContextMenuProps(null);\n    }\n\n    addEventListener('mousedown', onMouseDown);\n\n    return () => {\n      removeEventListener('mousedown', onMouseDown);\n    };\n  }, [isContextMenuOpen]);\n\n  function insertRow(insertRowIdx: number) {\n    const newRow: Row = {\n      id: nextId,\n      product: faker.commerce.productName(),\n      price: faker.commerce.price()\n    };\n\n    setRows(rows.toSpliced(insertRowIdx, 0, newRow));\n    setNextId();\n  }\n\n  return (\n    <>\n      <DataGrid\n        aria-label=\"Context Menu Example\"\n        rowKeyGetter={rowKeyGetter}\n        columns={columns}\n        rows={rows}\n        className=\"fill-grid\"\n        direction={direction}\n        onCellContextMenu={({ row }, event) => {\n          event.preventGridDefault();\n          // Do not show the default context menu\n          event.preventDefault();\n          setContextMenuProps({\n            rowIdx: rows.indexOf(row),\n            top: event.clientY,\n            left: event.clientX\n          });\n        }}\n      />\n      {isContextMenuOpen &&\n        createPortal(\n          <menu\n            ref={menuRef}\n            className={contextMenuClassname}\n            style={{\n              top: contextMenuProps.top,\n              left: contextMenuProps.left\n            }}\n          >\n            <li>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setRows(rows.toSpliced(contextMenuProps.rowIdx, 1));\n                  setContextMenuProps(null);\n                }}\n              >\n                Delete Row\n              </button>\n            </li>\n            <li>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  const { rowIdx } = contextMenuProps;\n                  insertRow(rowIdx);\n                  setContextMenuProps(null);\n                }}\n              >\n                Insert Row Above\n              </button>\n            </li>\n            <li>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  const { rowIdx } = contextMenuProps;\n                  insertRow(rowIdx + 1);\n                  setContextMenuProps(null);\n                }}\n              >\n                Insert Row Below\n              </button>\n            </li>\n          </menu>,\n          document.body\n        )}\n    </>\n  );\n}\n"],"mappings":"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"}