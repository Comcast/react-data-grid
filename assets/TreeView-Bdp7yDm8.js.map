{"version":3,"file":"TreeView-Bdp7yDm8.js","names":["e: React.KeyboardEvent<HTMLSpanElement>","useMemo","useReducer","useState","css","DataGrid","Column","CellExpanderFormatter","ChildRowDeleteButton","useDirection","Route","gridClassname","Row","id","name","format","position","price","children","parentId","isExpanded","Action","type","createRows","rows","i","Math","random","row","push","toggleSubRow","rowIndex","findIndex","r","newRows","with","splice","length","deleteSubRow","find","undefined","filter","parentRowIndex","newChildren","sr","reducer","defaultRows","SplitComponent","TreeView","direction","dispatch","allowDelete","setAllowDelete","columns","key","frozen","renderCell","tabIndex","hasChildren","style","marginInlineStart","component"],"sources":["../../website/components/ChildRowDeleteButton.tsx","../../website/routes/TreeView.tsx?tsr-split=component"],"sourcesContent":["import { css } from '@linaria/core';\n\nconst childRowActionCrossClassname = css`\n  block-size: 100%;\n  &::before,\n  &::after {\n    content: '';\n    position: absolute;\n    background: grey;\n  }\n\n  &::before {\n    inset-inline-start: 21px;\n    inline-size: 1px;\n    block-size: 100%;\n  }\n\n  &::after {\n    inset-block-start: 50%;\n    inset-inline-start: 21px;\n    block-size: 1px;\n    inline-size: 15px;\n  }\n\n  &:hover {\n    background: red;\n  }\n`;\n\nconst childRowButtonClassname = css`\n  cursor: pointer;\n  position: absolute;\n  inset-inline-start: 21px;\n  transform: translateX(-50%);\n  filter: grayscale(1);\n  &:dir(rtl) {\n    transform: translateX(50%);\n  }\n`;\n\ninterface ChildRowDeleteButtonProps {\n  tabIndex: number;\n  isDeleteSubRowEnabled: boolean;\n  onDeleteSubRow: () => void;\n}\n\nexport function ChildRowDeleteButton({\n  tabIndex,\n  onDeleteSubRow,\n  isDeleteSubRowEnabled\n}: ChildRowDeleteButtonProps) {\n  function handleKeyDown(e: React.KeyboardEvent<HTMLSpanElement>) {\n    if (e.key === 'Enter') {\n      // prevent scrolling\n      e.preventDefault();\n      onDeleteSubRow();\n    }\n  }\n\n  return (\n    <>\n      <div className={childRowActionCrossClassname} />\n      {isDeleteSubRowEnabled && (\n        <div className={childRowButtonClassname} onClick={onDeleteSubRow}>\n          <span tabIndex={tabIndex} onKeyDown={handleKeyDown}>\n            ‚ùå\n          </span>\n        </div>\n      )}\n    </>\n  );\n}\n","import { useMemo, useReducer, useState } from 'react';\nimport { css } from '@linaria/core';\n\nimport { DataGrid } from '../../src';\nimport type { Column } from '../../src';\nimport { CellExpanderFormatter, ChildRowDeleteButton } from '../components';\nimport { useDirection } from '../directionContext';\n\nexport const Route = createFileRoute({\n  component: TreeView\n});\n\nconst gridClassname = css`\n  block-size: 600px;\n`;\n\ninterface Row {\n  id: string;\n  name: string;\n  format: string;\n  position: string;\n  price: number;\n  children?: Row[];\n  parentId?: string;\n  isExpanded?: boolean;\n}\n\ninterface Action {\n  type: 'toggleSubRow' | 'deleteSubRow';\n  id: string;\n}\n\nfunction createRows(): Row[] {\n  const rows = [];\n  for (let i = 0; i < 100; i++) {\n    const price = Math.random() * 30;\n    const id = `row${i}`;\n    const row: Row = {\n      id,\n      name: `supplier ${i}`,\n      format: `package ${i}`,\n      position: 'Run of site',\n      price,\n      children: [\n        {\n          id: `${id}-0`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '728x90',\n          position: 'run of site',\n          price: price / 2\n        },\n        {\n          id: `${id}-1`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '480x600',\n          position: 'run of site',\n          price: price * 0.25\n        },\n        {\n          id: `${id}-2`,\n          parentId: id,\n          name: `supplier ${i}`,\n          format: '328x70',\n          position: 'run of site',\n          price: price * 0.25\n        }\n      ],\n      isExpanded: false\n    };\n    rows.push(row);\n  }\n  return rows;\n}\n\nfunction toggleSubRow(rows: Row[], id: string): Row[] {\n  const rowIndex = rows.findIndex((r) => r.id === id);\n  const row = rows[rowIndex];\n  const { children } = row;\n  if (!children) return rows;\n\n  const newRows = rows.with(rowIndex, { ...row, isExpanded: !row.isExpanded });\n  if (row.isExpanded) {\n    newRows.splice(rowIndex + 1, children.length);\n  } else {\n    newRows.splice(rowIndex + 1, 0, ...children);\n  }\n  return newRows;\n}\n\nfunction deleteSubRow(rows: Row[], id: string): Row[] {\n  const row = rows.find((r) => r.id === id);\n  if (row?.parentId === undefined) return rows;\n\n  // Remove sub row from flattened rows.\n  const newRows = rows.filter((r) => r.id !== id);\n\n  // Remove sub row from parent row.\n  const parentRowIndex = newRows.findIndex((r) => r.id === row.parentId);\n  const { children } = newRows[parentRowIndex];\n  if (children) {\n    const newChildren = children.filter((sr) => sr.id !== id);\n    newRows[parentRowIndex] = { ...newRows[parentRowIndex], children: newChildren };\n  }\n\n  return newRows;\n}\n\nfunction reducer(rows: Row[], { type, id }: Action): Row[] {\n  switch (type) {\n    case 'toggleSubRow':\n      return toggleSubRow(rows, id);\n    case 'deleteSubRow':\n      return deleteSubRow(rows, id);\n    default:\n      return rows;\n  }\n}\n\nconst defaultRows = createRows();\n\nfunction TreeView() {\n  const direction = useDirection();\n  const [rows, dispatch] = useReducer(reducer, defaultRows);\n  const [allowDelete, setAllowDelete] = useState(true);\n\n  const columns = useMemo((): readonly Column<Row>[] => {\n    return [\n      {\n        key: 'id',\n        name: 'id',\n        frozen: true\n      },\n      {\n        key: 'name',\n        name: 'Name'\n      },\n      {\n        key: 'format',\n        name: 'format',\n        renderCell({ row, tabIndex }) {\n          const hasChildren = row.children !== undefined;\n          const style = hasChildren ? undefined : { marginInlineStart: 30 };\n          return (\n            <div\n              className={css`\n                display: flex;\n                gap: 10px;\n                block-size: 100%;\n                align-items: center;\n              `}\n            >\n              {hasChildren && (\n                <CellExpanderFormatter\n                  tabIndex={tabIndex}\n                  expanded={row.isExpanded === true}\n                  onCellExpand={() => dispatch({ id: row.id, type: 'toggleSubRow' })}\n                />\n              )}\n              {!hasChildren && (\n                <ChildRowDeleteButton\n                  tabIndex={tabIndex}\n                  isDeleteSubRowEnabled={allowDelete}\n                  onDeleteSubRow={() => dispatch({ id: row.id, type: 'deleteSubRow' })}\n                />\n              )}\n              <div style={style}>{row.format}</div>\n            </div>\n          );\n        }\n      },\n      {\n        key: 'position',\n        name: 'position'\n      },\n      {\n        key: 'price',\n        name: 'price'\n      }\n    ];\n  }, [allowDelete]);\n\n  return (\n    <>\n      <label>\n        Allow Delete\n        <input\n          type=\"checkbox\"\n          checked={allowDelete}\n          onChange={() => setAllowDelete(!allowDelete)}\n        />\n      </label>\n      <DataGrid\n        aria-label=\"TreeView Example\"\n        columns={columns}\n        rows={rows}\n        className={gridClassname}\n        direction={direction}\n      />\n    </>\n  );\n}\n"],"mappings":"uPAEA,MAAM,EAAA,UA2BA,EAAA,WAiBN,SAAgB,EAAqB,CACnC,WACA,iBACA,wBAC0B,CAAE,CAC5B,SAAS,EAAcA,EAAyC,CAC9D,AAAI,EAAE,MAAQ,UAEZ,EAAE,gBAAgB,CAClB,GAAgB,CAEnB,CAED,MACE,CAAA,EAAA,EAAA,MAAA,EAAA,SAAA,CAAA,SAAA,CACE,CAAA,EAAA,EAAA,KAAC,MAAA,CAAI,UAAW,CAAA,EAAgC,CAC/C,GACC,CAAA,EAAA,EAAA,KAAC,MAAA,CAAI,UAAW,EAAyB,QAAS,WAChD,CAAA,EAAA,EAAA,KAAC,OAAA,CAAe,WAAU,UAAW,WAAe,OAGhD,CAAA,EAEP,AAEN,cC3DD,MAAMW,EAAAA,WAoBN,SAASY,GAAoB,CAC3B,IAAMC,EAAO,CAAE,EACf,IAAK,IAAIC,EAAI,EAAGA,EAAI,IAAKA,IAAK,CAC5B,IAAMR,EAAQS,KAAKC,QAAQ,CAAG,GACxBd,GAAAA,KAAWY,EAAAA,EACXG,EAAW,CACff,KACAC,MAAAA,WAAkBW,EAAAA,EAClBV,QAAAA,UAAmBU,EAAAA,EACnBT,SAAU,cACVC,QACAC,SAAU,CACR,CACEL,IAAAA,EAAOA,EAAAA,IACPM,SAAUN,EACVC,MAAAA,WAAkBW,EAAAA,EAClBV,OAAQ,SACRC,SAAU,cACVC,MAAOA,EAAQ,CAChB,EACD,CACEJ,IAAAA,EAAOA,EAAAA,IACPM,SAAUN,EACVC,MAAAA,WAAkBW,EAAAA,EAClBV,OAAQ,UACRC,SAAU,cACVC,MAAOA,EAAQ,GAChB,EACD,CACEJ,IAAAA,EAAOA,EAAAA,IACPM,SAAUN,EACVC,MAAAA,WAAkBW,EAAAA,EAClBV,OAAQ,SACRC,SAAU,cACVC,MAAOA,EAAQ,GAChB,CACF,EACDG,YAAY,CACb,EACDI,EAAKK,KAAKD,EAAI,AAChB,CACA,OAAOJ,CACT,CAEA,SAASM,EAAaN,EAAaX,EAAmB,CACpD,IAAMkB,EAAWP,EAAKQ,UAAWC,GAAMA,EAAEpB,KAAOA,EAAG,CAC7Ce,EAAMJ,EAAKO,GACX,CAAEb,WAAU,CAAGU,EACrB,IAAKV,EAAU,OAAOM,EAEtB,IAAMU,EAAUV,EAAKW,KAAKJ,EAAU,CAAE,GAAGH,EAAKR,YAAaQ,EAAIR,UAAY,EAAC,CAM5E,OALIQ,EAAIR,WACNc,EAAQE,OAAOL,EAAW,EAAGb,EAASmB,OAAO,CAE7CH,EAAQE,OAAOL,EAAW,EAAG,EAAG,GAAGb,EAAS,CAEvCgB,CACT,CAEA,SAASI,EAAad,EAAaX,EAAmB,CACpD,IAAMe,EAAMJ,EAAKe,KAAMN,GAAMA,EAAEpB,KAAOA,EAAG,CACzC,GAAIe,GAAKT,eAAAA,GAAwB,OAAOK,EAGxC,IAAMU,EAAUV,EAAKiB,OAAQR,GAAMA,EAAEpB,KAAOA,EAAG,CAGzC6B,EAAiBR,EAAQF,UAAWC,GAAMA,EAAEpB,KAAOe,EAAIT,SAAS,CAChE,CAAED,WAAU,CAAGgB,EAAQQ,GAC7B,GAAIxB,EAAU,CACZ,IAAMyB,EAAczB,EAASuB,OAAQG,GAAOA,EAAG/B,KAAOA,EAAG,CACzDqB,EAAQQ,GAAkB,CAAE,GAAGR,EAAQQ,GAAiBxB,SAAUyB,CAAa,CACjF,CAEA,OAAOT,CACT,CAEA,SAASW,EAAQrB,EAAa,CAAEF,OAAMT,KAAY,CAAS,CACzD,OAAQS,EAAR,CACE,IAAK,eACH,MAAOQ,GAAaN,EAAMX,EAAG,CAC/B,IAAK,eACH,MAAOyB,GAAad,EAAMX,EAAG,CAC/B,QACE,OAAOW,CACX,CACF,CAEA,MAAMsB,EAAcvB,GAAY,CAACwB,EAAA,UAEb,CAClB,IAAME,EAAYxC,GAAc,CAC1B,CAACe,EAAM0B,EAAS,CAAGhD,CAAAA,EAAAA,EAAAA,YAAW2C,EAASC,EAAY,CACnD,CAACK,EAAaC,EAAe,CAAGjD,CAAAA,EAAAA,EAAAA,WAAS,EAAK,CAE9CkD,EAAUpD,CAAAA,EAAAA,EAAAA,SAAQ,IACf,CACL,CACEqD,IAAK,KACLxC,KAAM,KACNyC,QAAQ,CACT,EACD,CACED,IAAK,OACLxC,KAAM,MACP,EACD,CACEwC,IAAK,SACLxC,KAAM,SACN0C,WAAW,CAAE5B,MAAK6B,WAAU,CAAE,CAC5B,IAAMC,EAAc9B,EAAIV,eAAAA,GAClByC,EAAQD,MAAAA,GAA0B,CAAEE,kBAAmB,EAAI,EACjE,MACE,CAAA,EAAA,EAAA,MAAC,MAAA,CACC,UAAA,oBAOCF,GACC,CAAA,EAAA,EAAA,KAAC,EAAA,CACWD,WACV,SAAU7B,EAAIR,cAAe,EAC7B,aAAc,IAAM8B,EAAS,CAAErC,GAAIe,EAAIf,GAAIS,KAAM,cAAgB,EAAA,EAEpE,EACCoC,GACA,CAAA,EAAA,EAAA,KAAC,EAAA,CACWD,WACV,sBAAuBN,EACvB,eAAgB,IAAMD,EAAS,CAAErC,GAAIe,EAAIf,GAAIS,KAAM,cAAgB,EAAA,EAEtE,CACD,CAAA,EAAA,EAAA,KAAC,MAAA,CAAWqC,iBAAQ/B,EAAIb,QAAY,GAChC,AAEV,CACD,EACD,CACEuC,IAAK,WACLxC,KAAM,UACP,EACD,CACEwC,IAAK,QACLxC,KAAM,OACP,CACF,EACA,CAACqC,CAAY,EAAC,CAEjB,MACE,CAAA,EAAA,EAAA,MAAA,EAAA,SAAA,CAAA,SAAA,CACE,CAAA,EAAA,EAAA,MAAC,QAAA,CAAA,SAAA,CAAK,eAEJ,CAAA,EAAA,EAAA,KAAC,QAAA,CACC,KAAK,WACL,QAASA,EACT,SAAU,IAAMC,GAAgBD,EAAAA,EAAa,CAAA,EAE1C,CACP,CAAA,EAAA,EAAA,KAAC,EAAA,CACC,aAAW,mBACFE,UACH7B,OACN,UAAWb,EACAsC,aAAU,CAAA,EAEtB,AAEN"}