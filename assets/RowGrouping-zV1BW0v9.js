import{_ as e,a as t,c as n,d as r,g as i,h as a,i as o,l as s,m as c,p as l,r as u,s as d,t as f,u as p,v as m,y as h}from"./DataGrid-CpYr3_eT.js";import{c as g,d as _,l as v,m as y,n as b}from"./index-CAJApQaG.js";var x=v(),S=`rdg-group-cell-content css-07919382`,C=`rdg-caret css-02a50147`;function w(e){return(0,x.jsx)(T,{...e})}function T({groupKey:e,isExpanded:t,tabIndex:n,toggleGroup:r}){function i({key:e}){e===`Enter`&&r()}let a=t?`M1 1 L 7 7 L 13 1`:`M1 7 L 7 1 L 13 7`;return(0,x.jsxs)(`span`,{className:S,tabIndex:n,onKeyDown:i,children:[e,(0,x.jsx)(`svg`,{viewBox:`0 0 14 8`,width:`14`,height:`8`,className:C,"aria-hidden":!0,children:(0,x.jsx)(`path`,{d:a})})]})}var E=y(_(),1);function D({id:t,groupKey:n,childRows:r,isExpanded:a,isCellSelected:o,column:s,row:c,groupColumnIndex:l,isGroupByColumn:u,toggleGroup:f}){let{tabIndex:p,childTabIndex:m,onFocus:h}=d(o);function g(){f(t)}let _=u&&l===s.idx;return(0,x.jsx)(`div`,{role:`gridcell`,"aria-colindex":s.idx+1,"aria-selected":o,tabIndex:p,className:i(s),style:{...e(s),cursor:_?`pointer`:`default`},onMouseDown:e=>{e.preventDefault()},onClick:_?g:void 0,onFocus:h,children:(!u||_)&&s.renderGroupCell?.({groupKey:n,childRows:r,column:s,row:c,isExpanded:a,tabIndex:m,toggleGroup:g})},s.key)}var O=(0,E.memo)(D),k=`rdg-group-row css-e74a2be3`;function A({className:e,row:t,rowIdx:n,viewportColumns:i,selectedCellIdx:s,isRowSelected:c,selectCell:l,gridRowStart:u,groupBy:d,toggleGroup:f,isRowSelectionDisabled:p,...h}){let g=i[0].key===`rdg-select-column`?t.level+1:t.level;function _(){l({rowIdx:n,idx:-1},{shouldFocusCell:!0})}return(0,x.jsx)(r,{value:(0,E.useMemo)(()=>({isRowSelectionDisabled:!1,isRowSelected:c}),[c]),children:(0,x.jsx)(`div`,{role:`row`,"aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:a(o,k,`rdg-row-${n%2==0?`even`:`odd`}`,s===-1&&`rdg-row-selected`,e),onMouseDown:_,style:m(u),...h,children:i.map(e=>(0,x.jsx)(O,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:s===e.idx,column:e,row:t,groupColumnIndex:g,toggleGroup:f,isGroupByColumn:d.includes(e.key)},e.key))})})}var j=(0,E.memo)(A);function M({columns:e,rows:t,rowHeight:r,rowKeyGetter:i,onCellKeyDown:a,onCellCopy:o,onCellPaste:s,onRowsChange:d,selectedRows:p,onSelectedRowsChange:m,renderers:g,groupBy:_,rowGrouper:v,expandedGroupIds:y,onExpandedGroupIdsChange:b,groupIdGetter:S,...C}){let T=l(),D=g?.renderRow??T?.renderRow??u,O=1+(C.topSummaryRows?.length??0),{leftKey:k,rightKey:A}=h(C.direction),M=n(Z),F=S??N,{columns:I,groupBy:L}=(0,E.useMemo)(()=>{let t=e.toSorted(({key:e},{key:t})=>e===`rdg-select-column`?-1:t===`rdg-select-column`?1:_.includes(e)?_.includes(t)?_.indexOf(e)-_.indexOf(t):-1:_.includes(t)?1:0),n=[];for(let[e,r]of t.entries())_.includes(r.key)&&(n.push(r.key),t[e]={...r,frozen:!0,renderCell:()=>null,renderGroupCell:r.renderGroupCell??w,editable:!1});return{columns:t,groupBy:n}},[e,_]),[R,z]=(0,E.useMemo)(()=>{if(L.length===0)return[void 0,t.length];let e=(t,[n,...r],i)=>{let a=0,o={};for(let[s,c]of Object.entries(v(t,n))){let[t,n]=r.length===0?[c,c.length]:e(c,r,i+a+1);o[s]={childRows:c,childGroups:t,startRowIndex:i+a},a+=n+1}return[o,a]};return e(t,L,0)},[L,v,t]),[B,V]=(0,E.useMemo)(()=>{let e=new Set;if(!R)return[t,i];let n=[],r=(t,i,a)=>{if(P(t)){n.push(...t);return}Object.keys(t).forEach((o,s,c)=>{let l=F(o,i),u=y.has(l),{childRows:d,childGroups:f,startRowIndex:p}=t[o],m={id:l,parentId:i,groupKey:o,isExpanded:u,childRows:d,level:a,posInSet:s,startRowIndex:p,setSize:c.length};n.push(m),e.add(m),u&&r(f,l,a+1)})};return r(R,void 0,0),[n,i];function i(t){return e.has(t)}},[y,R,t,F]),H=(0,E.useMemo)(()=>typeof r==`function`?e=>V(e)?r({type:`GROUP`,row:e}):r({type:`ROW`,row:e}):r,[V,r]),U=(0,E.useCallback)(e=>{let t=B.indexOf(e);for(let n=t-1;n>=0;n--){let t=B[n];if(V(t)&&(!V(e)||e.parentId===t.id))return[t,n]}},[V,B]),W=(0,E.useCallback)(e=>{if(V(e))return e.id;if(typeof i==`function`)return i(e);let t=U(e);if(t!==void 0){let{startRowIndex:n,childRows:r}=t[0];return n+r.indexOf(e)+1}return B.indexOf(e)},[U,V,i,B]),G=(0,E.useMemo)(()=>{if(p==null)return null;c(i);let e=new Set(p);for(let t of B)V(t)&&t.childRows.every(e=>p.has(i(e)))&&e.add(t.id);return e},[V,i,p,B]);function K(e){if(!m)return;c(i);let t=new Set(p);for(let n of B){let r=W(n);if(G?.has(r)&&!e.has(r))if(V(n))for(let e of n.childRows)t.delete(i(e));else t.delete(r);else if(!G?.has(r)&&e.has(r))if(V(n))for(let e of n.childRows)t.add(i(e));else t.add(r)}m(t)}function q(e,t){if(a?.(e,t),t.isGridDefaultPrevented()||e.mode===`EDIT`)return;let{column:n,rowIdx:r,selectCell:i}=e,o=n?.idx??-1,s=B[r];if(V(s)&&(o===-1&&(t.key===k&&s.isExpanded||t.key===A&&!s.isExpanded)&&(t.preventDefault(),t.preventGridDefault(),Z(s.id)),o===-1&&t.key===k&&!s.isExpanded&&s.level!==0)){let e=U(s);e!==void 0&&(t.preventGridDefault(),i({idx:o,rowIdx:e[1]}))}}function J({row:e,column:t},n){V(e)||o?.({row:e,column:t},n)}function Y({row:e,column:t},n){return V(e)?e:s({row:e,column:t},n)}function X(e,{indexes:n,column:r}){if(!d)return;let i=[...t],a=[];for(let r of n){let n=t.indexOf(B[r]);i[n]=e[r],a.push(n)}d(i,{indexes:a,column:r})}function Z(e){let t=new Set(y);t.has(e)?t.delete(e):t.add(e),b(t)}function Q(e,{row:t,rowClass:n,onCellMouseDown:r,onCellClick:i,onCellDoubleClick:a,onCellContextMenu:o,onRowChange:s,lastFrozenColumnIndex:c,draggedOverCellIdx:l,selectedCellEditor:u,...d}){if(V(t)){let{startRowIndex:n}=t;return(0,x.jsx)(j,{...d,"aria-rowindex":O+n+1,row:t,groupBy:L,toggleGroup:M},e)}let f=d[`aria-rowindex`],p=U(t);if(p!==void 0){let{startRowIndex:e,childRows:n}=p[0],r=n.indexOf(t);f=e+O+r+2}return D(e,{...d,"aria-rowindex":f,row:t,rowClass:n,onCellMouseDown:r,onCellClick:i,onCellDoubleClick:a,onCellContextMenu:o,onRowChange:s,lastFrozenColumnIndex:c,draggedOverCellIdx:l,selectedCellEditor:u})}return(0,x.jsx)(f,{...C,role:`treegrid`,"aria-rowcount":z+1+(C.topSummaryRows?.length??0)+(C.bottomSummaryRows?.length??0),columns:I,rows:B,rowHeight:H,rowKeyGetter:W,onRowsChange:X,selectedRows:G,onSelectedRowsChange:K,onCellKeyDown:q,onCellCopy:J,onCellPaste:s?Y:void 0,renderers:{...g,renderRow:Q}})}function N(e,t){return t===void 0?e:`${t}__${e}`}function P(e){return Array.isArray(e)}var F=`css-e3d1eb5c`,I=`css-16efb599`,L=`Swimming.Gymnastics.Speed Skating.Cross Country Skiing.Short-Track Speed Skating.Diving.Cycling.Biathlon.Alpine Skiing.Ski Jumping.Nordic Combined.Athletics.Table Tennis.Tennis.Synchronized Swimming.Shooting.Rowing.Fencing.Equestrian.Canoeing.Bobsleigh.Badminton.Archery.Wrestling.Weightlifting.Waterpolo.Wrestling.Weightlifting`.split(`.`),R=[p,{key:`country`,name:`Country`},{key:`year`,name:`Year`},{key:`sport`,name:`Sport`},{key:`athlete`,name:`Athlete`},{key:`gold`,name:`Gold`,renderGroupCell({childRows:e}){return e.reduce((e,{gold:t})=>e+t,0)}},{key:`silver`,name:`Silver`,renderGroupCell({childRows:e}){return e.reduce((e,{silver:t})=>e+t,0)}},{key:`bronze`,name:`Bronze`,renderGroupCell({childRows:e}){return e.reduce((e,{silver:t})=>e+t,0)}},{key:`total`,name:`Total`,renderCell({row:e}){return e.gold+e.silver+e.bronze},renderGroupCell({childRows:e}){return e.reduce((e,t)=>e+t.gold+t.silver+t.bronze,0)}}];function z(e){return e.id}function B(){let e=[];for(let t=1;t<1e4;t++)e.push({id:t,year:2015+b.number.int(3),country:b.location.country(),sport:L[b.number.int(L.length-1)],athlete:b.person.fullName(),gold:b.number.int(5),silver:b.number.int(5),bronze:b.number.int(5)});return e.sort((e,t)=>t.country.localeCompare(e.country))}var V=[`country`,`year`,`sport`,`athlete`];function H(){let e=g(),[t]=(0,E.useState)(B),[n,r]=(0,E.useState)(()=>new Set),[i,a]=(0,E.useState)([V[0],V[1]]),[o,s]=(0,E.useState)(()=>new Set([`United States of America`,`United States of America__2015`]));function c(e,t){let n=i.indexOf(e);t?n===-1&&a(t=>[...t,e]):n!==-1&&a(e=>e.toSpliced(n,1)),s(new Set)}return(0,x.jsxs)(`div`,{className:F,children:[(0,x.jsx)(`b`,{children:`Group by columns:`}),(0,x.jsx)(`div`,{className:I,children:V.map(e=>(0,x.jsxs)(`label`,{children:[(0,x.jsx)(`input`,{type:`checkbox`,checked:i.includes(e),onChange:t=>c(e,t.target.checked)}),` `,e]},e))}),(0,x.jsx)(M,{"aria-label":`Row Grouping Example`,columns:R,rows:t,rowKeyGetter:z,selectedRows:n,onSelectedRowsChange:r,groupBy:i,rowGrouper:U,expandedGroupIds:o,onExpandedGroupIdsChange:s,defaultColumnOptions:{resizable:!0},direction:e})]})}function U(e,t){return Object.groupBy(e,e=>e[t])}export{H as component};
//# sourceMappingURL=RowGrouping-zV1BW0v9.js.map