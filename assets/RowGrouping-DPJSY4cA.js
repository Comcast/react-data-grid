import{j as f,r as h,u as ue,f as D}from"./index-CHWLqwqL.js";import{u as ae,g as fe,a as pe,S as F,b as ge,d as he,c as xe,r as me,e as Ce,f as ye,h as Re,i as Se,j as ke,k as Q,D as Ge,l as be}from"./DataGrid-DN-oQvCc.js";const ve="g1s9ylgp",Ie=`rdg-group-cell-content ${ve}`,je="cz54e4y",Ee=`rdg-caret ${je}`;function De(s){return f.jsx(Oe,{...s})}function Oe({groupKey:s,isExpanded:t,tabIndex:i,toggleGroup:d}){function y({key:R}){R==="Enter"&&d()}const c=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return f.jsxs("span",{className:Ie,tabIndex:i,onKeyDown:y,children:[s,f.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:Ee,"aria-hidden":!0,children:f.jsx("path",{d:c})})]})}function we({id:s,groupKey:t,childRows:i,isExpanded:d,isCellSelected:y,column:c,row:R,groupColumnIndex:v,isGroupByColumn:x,toggleGroup:I}){const{tabIndex:m,childTabIndex:p,onFocus:k}=ae(y);function C(){I(s)}const E=x&&v===c.idx;return f.jsx("div",{role:"gridcell","aria-colindex":c.idx+1,"aria-selected":y,tabIndex:m,className:pe(c),style:{...fe(c),cursor:E?"pointer":"default"},onClick:E?C:void 0,onFocus:k,children:(!x||E)&&c.renderGroupCell?.({groupKey:t,childRows:i,column:c,row:R,isExpanded:d,tabIndex:p,toggleGroup:C})},c.key)}const Ae=h.memo(we),ze="g1yxluv3",Te=`rdg-group-row ${ze}`;function Le({className:s,row:t,rowIdx:i,viewportColumns:d,selectedCellIdx:y,isRowSelected:c,selectCell:R,gridRowStart:v,groupBy:x,toggleGroup:I,isRowSelectionDisabled:m,...p}){const k=d[0].key===F?t.level+1:t.level;function C(){R({rowIdx:i,idx:-1})}const E=h.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:c}),[c]);return f.jsx(ge,{value:E,children:f.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:xe(me,Te,`rdg-row-${i%2===0?"even":"odd"}`,y===-1&&Ce,s),onClick:C,style:he(v),...p,children:d.map(O=>f.jsx(Ae,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:y===O.idx,column:O,row:t,groupColumnIndex:k,toggleGroup:I,isGroupByColumn:x.includes(O.key)},O.key))})})}const Me=h.memo(Le);function Ne({columns:s,rows:t,rowHeight:i,rowKeyGetter:d,onCellKeyDown:y,onCellCopy:c,onCellPaste:R,onRowsChange:v,selectedRows:x,onSelectedRowsChange:I,renderers:m,groupBy:p,rowGrouper:k,expandedGroupIds:C,onExpandedGroupIdsChange:E,groupIdGetter:O,...w}){const Z=ye(),H=m?.renderRow??Z?.renderRow??Re,P=1+(w.topSummaryRows?.length??0),{leftKey:V,rightKey:K}=Se(w.direction),ee=ke(J),Y=O??$e,{columns:ne,groupBy:L}=h.useMemo(()=>{const e=s.toSorted(({key:r},{key:o})=>r===F?-1:o===F?1:p.includes(r)?p.includes(o)?p.indexOf(r)-p.indexOf(o):-1:p.includes(o)?1:0),n=[];for(const[r,o]of e.entries())p.includes(o.key)&&(n.push(o.key),e[r]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??De,editable:!1});return{columns:e,groupBy:n}},[s,p]),[W,te]=h.useMemo(()=>{if(L.length===0)return[void 0,t.length];const e=(n,[r,...o],l)=>{let a=0;const u={};for(const[G,j]of Object.entries(k(n,r))){const[A,b]=o.length===0?[j,j.length]:e(j,o,l+a+1);u[G]={childRows:j,childGroups:A,startRowIndex:l+a},a+=b+1}return[u,a]};return e(t,L,0)},[L,k,t]),[S,g]=h.useMemo(()=>{const e=new Set;if(!W)return[t,o];const n=[],r=(l,a,u)=>{if(We(l)){n.push(...l);return}Object.keys(l).forEach((G,j,A)=>{const b=Y(G,a),z=C.has(b),{childRows:N,childGroups:T,startRowIndex:B}=l[G],$={id:b,parentId:a,groupKey:G,isExpanded:z,childRows:N,level:u,posInSet:j,startRowIndex:B,setSize:A.length};n.push($),e.add($),z&&r(T,b,u+1)})};return r(W,void 0,0),[n,o];function o(l){return e.has(l)}},[C,W,t,Y]),oe=h.useMemo(()=>typeof i=="function"?e=>g(e)?i({type:"GROUP",row:e}):i({type:"ROW",row:e}):i,[g,i]),M=h.useCallback(e=>{const n=S.indexOf(e);for(let r=n-1;r>=0;r--){const o=S[r];if(g(o)&&(!g(e)||e.parentId===o.id))return[o,r]}},[g,S]),q=h.useCallback(e=>{if(g(e))return e.id;if(typeof d=="function")return d(e);const n=M(e);if(n!==void 0){const{startRowIndex:r,childRows:o}=n[0],l=o.indexOf(e);return r+l+1}return S.indexOf(e)},[M,g,d,S]),_=h.useMemo(()=>{if(x==null)return null;Q(d);const e=new Set(x);for(const n of S)g(n)&&n.childRows.every(o=>x.has(d(o)))&&e.add(n.id);return e},[g,d,x,S]);function se(e){if(!I)return;Q(d);const n=new Set(x);for(const r of S){const o=q(r);if(_?.has(o)&&!e.has(o))if(g(r))for(const l of r.childRows)n.delete(d(l));else n.delete(o);else if(!_?.has(o)&&e.has(o))if(g(r))for(const l of r.childRows)n.add(d(l));else n.add(o)}I(n)}function re(e,n){if(y?.(e,n),n.isGridDefaultPrevented()||e.mode==="EDIT")return;const{column:r,rowIdx:o,selectCell:l}=e,a=r?.idx??-1,u=S[o];if(g(u)&&(a===-1&&(n.key===V&&u.isExpanded||n.key===K&&!u.isExpanded)&&(n.preventDefault(),n.preventGridDefault(),J(u.id)),a===-1&&n.key===V&&!u.isExpanded&&u.level!==0)){const G=M(u);G!==void 0&&(n.preventGridDefault(),l({idx:a,rowIdx:G[1]}))}}function ie({row:e,column:n},r){g(e)||c?.({row:e,column:n},r)}function le({row:e,column:n},r){return g(e)?e:R({row:e,column:n},r)}function de(e,{indexes:n,column:r}){if(!v)return;const o=[...t],l=[];for(const a of n){const u=t.indexOf(S[a]);o[u]=e[a],l.push(u)}v(o,{indexes:l,column:r})}function J(e){const n=new Set(C);n.has(e)?n.delete(e):n.add(e),E(n)}function ce(e,{row:n,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:G,draggedOverCellIdx:j,selectedCellEditor:A,...b}){if(g(n)){const{startRowIndex:T}=n;return f.jsx(Me,{...b,"aria-rowindex":P+T+1,row:n,groupBy:L,toggleGroup:ee},e)}let z=b["aria-rowindex"];const N=M(n);if(N!==void 0){const{startRowIndex:T,childRows:B}=N[0],$=B.indexOf(n);z=T+P+$+2}return H(e,{...b,"aria-rowindex":z,row:n,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:G,draggedOverCellIdx:j,selectedCellEditor:A})}return f.jsx(Ge,{...w,role:"treegrid","aria-rowcount":te+1+(w.topSummaryRows?.length??0)+(w.bottomSummaryRows?.length??0),columns:ne,rows:S,rowHeight:oe,rowKeyGetter:q,onRowsChange:de,selectedRows:_,onSelectedRowsChange:se,onCellKeyDown:re,onCellCopy:ie,onCellPaste:R?le:void 0,renderers:{...m,renderRow:ce}})}function $e(s,t){return t!==void 0?`${t}__${s}`:s}function We(s){return Array.isArray(s)}const _e="g8apzrt",Be="o12aimxb",X=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],Ue=[be,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:s}){return s.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:s}){return s.gold+s.silver+s.bronze},renderGroupCell({childRows:s}){return s.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function Fe(s){return s.id}function Pe(){const s=[];for(let t=1;t<1e4;t++)s.push({id:t,year:2015+D.number.int(3),country:D.location.country(),sport:X[D.number.int(X.length-1)],athlete:D.person.fullName(),gold:D.number.int(5),silver:D.number.int(5),bronze:D.number.int(5)});return s.sort((t,i)=>i.country.localeCompare(t.country))}const U=["country","year","sport","athlete"];function Ve(s,t){return Object.groupBy(s,i=>i[t])}const Je=function(){const t=ue(),[i]=h.useState(Pe),[d,y]=h.useState(()=>new Set),[c,R]=h.useState([U[0],U[1]]),[v,x]=h.useState(()=>new Set(["United States of America","United States of America__2015"]));function I(m,p){const k=c.indexOf(m);p?k===-1&&R(C=>[...C,m]):k!==-1&&R(C=>C.toSpliced(k,1)),x(new Set)}return f.jsxs("div",{className:_e,children:[f.jsx("b",{children:"Group by columns:"}),f.jsx("div",{className:Be,children:U.map(m=>f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:c.includes(m),onChange:p=>I(m,p.target.checked)})," ",m]},m))}),f.jsx(Ne,{columns:Ue,rows:i,rowKeyGetter:Fe,selectedRows:d,onSelectedRowsChange:y,groupBy:c,rowGrouper:Ve,expandedGroupIds:v,onExpandedGroupIdsChange:x,defaultColumnOptions:{resizable:!0},direction:t})]})};export{Je as component};
//# sourceMappingURL=RowGrouping-DPJSY4cA.js.map
