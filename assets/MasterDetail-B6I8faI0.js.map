{"version":3,"file":"MasterDetail-B6I8faI0.js","sources":["../../website/routes/MasterDetail.tsx?tsr-split=component"],"sourcesContent":["import { useMemo, useState } from 'react';\nimport { faker } from '@faker-js/faker';\nimport { createFileRoute } from '@tanstack/react-router';\nimport { css } from '@linaria/core';\n\nimport { DataGrid } from '../../src';\nimport type { Column, RowsChangeData } from '../../src';\nimport type { Direction } from '../../src/types';\nimport { CellExpanderFormatter } from '../components';\nimport { useDirection } from '../directionContext';\n\nexport const Route = createFileRoute('/MasterDetail')({\n  component: MasterDetail\n});\n\ntype DepartmentRow =\n  | {\n      type: 'MASTER';\n      id: number;\n      department: string;\n      expanded: boolean;\n    }\n  | {\n      type: 'DETAIL';\n      id: number;\n      parentId: number;\n    };\n\ninterface ProductRow {\n  id: number;\n  product: string;\n  description: string;\n  price: string;\n}\n\nfunction createDepartments(): readonly DepartmentRow[] {\n  const departments: DepartmentRow[] = [];\n  for (let i = 1; i < 30; i++) {\n    departments.push({\n      type: 'MASTER',\n      id: i,\n      department: faker.commerce.department(),\n      expanded: false\n    });\n  }\n  return departments;\n}\n\nconst productsMap = new Map<number, readonly ProductRow[]>();\n\nfunction getProducts(parentId: number): readonly ProductRow[] {\n  if (productsMap.has(parentId)) return productsMap.get(parentId)!;\n  const products: ProductRow[] = [];\n  for (let i = 0; i < 20; i++) {\n    products.push({\n      id: i,\n      product: faker.commerce.productName(),\n      description: faker.commerce.productDescription(),\n      price: faker.commerce.price()\n    });\n  }\n  productsMap.set(parentId, products);\n  return products;\n}\n\nconst productColumns: readonly Column<ProductRow>[] = [\n  { key: 'id', name: 'ID', width: 35 },\n  { key: 'product', name: 'Product' },\n  { key: 'description', name: 'Description' },\n  { key: 'price', name: 'Price' }\n];\n\nfunction MasterDetail() {\n  const direction = useDirection();\n\n  const columns = useMemo((): readonly Column<DepartmentRow>[] => {\n    return [\n      {\n        key: 'expanded',\n        name: '',\n        minWidth: 30,\n        width: 30,\n        colSpan(args) {\n          return args.type === 'ROW' && args.row.type === 'DETAIL' ? 3 : undefined;\n        },\n        cellClass(row) {\n          return row.type === 'DETAIL'\n            ? css`\n                padding: 24px;\n              `\n            : undefined;\n        },\n        renderCell({ row, tabIndex, onRowChange }) {\n          if (row.type === 'DETAIL') {\n            return <ProductGrid parentId={row.parentId} direction={direction} />;\n          }\n\n          return (\n            <CellExpanderFormatter\n              expanded={row.expanded}\n              tabIndex={tabIndex}\n              onCellExpand={() => {\n                onRowChange({ ...row, expanded: !row.expanded });\n              }}\n            />\n          );\n        }\n      },\n      { key: 'id', name: 'ID', width: 35 },\n      { key: 'department', name: 'Department' }\n    ];\n  }, [direction]);\n  const [rows, setRows] = useState(createDepartments);\n\n  function onRowsChange(rows: DepartmentRow[], { indexes }: RowsChangeData<DepartmentRow>) {\n    const row = rows[indexes[0]];\n    if (row.type === 'MASTER') {\n      if (row.expanded) {\n        rows.splice(indexes[0] + 1, 0, {\n          type: 'DETAIL',\n          id: row.id + 100,\n          parentId: row.id\n        });\n      } else {\n        rows.splice(indexes[0] + 1, 1);\n      }\n      setRows(rows);\n    }\n  }\n\n  return (\n    <DataGrid\n      rowKeyGetter={rowKeyGetter}\n      columns={columns}\n      rows={rows}\n      onRowsChange={onRowsChange}\n      headerRowHeight={45}\n      rowHeight={(row) => (row.type === 'DETAIL' ? 300 : 45)}\n      className=\"fill-grid\"\n      enableVirtualization={false}\n      direction={direction}\n      onCellKeyDown={(_, event) => {\n        if (event.isDefaultPrevented()) {\n          // skip parent grid keyboard navigation if nested grid handled it\n          event.preventGridDefault();\n        }\n      }}\n    />\n  );\n}\n\nfunction ProductGrid({ parentId, direction }: { parentId: number; direction: Direction }) {\n  const products = getProducts(parentId);\n\n  return (\n    <DataGrid\n      rows={products}\n      columns={productColumns}\n      rowKeyGetter={rowKeyGetter}\n      style={{ blockSize: 250 }}\n      direction={direction}\n    />\n  );\n}\n\nfunction rowKeyGetter(row: DepartmentRow | ProductRow) {\n  return row.id;\n}\n"],"names":["createDepartments","departments","i","push","type","id","department","faker","commerce","expanded","productsMap","Map","getProducts","parentId","has","get","products","product","productName","description","productDescription","price","set","productColumns","key","name","width","ProductGrid","direction","DataGrid","rows","columns","rowKeyGetter","style","blockSize","row","SplitComponent","useDirection","useMemo","minWidth","colSpan","args","undefined","cellClass","css","renderCell","tabIndex","onRowChange","jsx","CellExpanderFormatter","onCellExpand","setRows","useState","onRowsChange","indexes","splice","headerRowHeight","rowHeight","className","enableVirtualization","onCellKeyDown","_","event","isDefaultPrevented","preventGridDefault"],"mappings":"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"}