import{j as f,r as h,u as ae,f as w}from"./index-Cjv61NC9.js";import{u as fe,g as pe,a as ge,S as U,R as he,b as xe,c as me,r as Ce,d as ye,e as Re,f as Se,h as ke,i as Ge,j as Q,D as be,k as ve}from"./DataGrid-CyKO8ptL.js";const Ie="g1s9ylgp",je=`rdg-group-cell-content ${Ie}`,De="cz54e4y",Ee=`rdg-caret ${De}`;function we(s){return f.jsx(Oe,{...s})}function Oe({groupKey:s,isExpanded:t,tabIndex:i,toggleGroup:d}){function y({key:R}){R==="Enter"&&d()}const c=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return f.jsxs("span",{className:je,tabIndex:i,onKeyDown:y,children:[s,f.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:Ee,"aria-hidden":!0,children:f.jsx("path",{d:c})})]})}function Ae({id:s,groupKey:t,childRows:i,isExpanded:d,isCellSelected:y,column:c,row:R,groupColumnIndex:b,isGroupByColumn:x,toggleGroup:v}){const{tabIndex:m,childTabIndex:p,onFocus:k}=fe(y);function C(){v(s)}const D=x&&b===c.idx;return f.jsx("div",{role:"gridcell","aria-colindex":c.idx+1,"aria-selected":y,tabIndex:m,className:ge(c),style:{...pe(c),cursor:D?"pointer":"default"},onMouseDown:I=>{I.preventDefault()},onClick:D?C:void 0,onFocus:k,children:(!x||D)&&c.renderGroupCell?.({groupKey:t,childRows:i,column:c,row:R,isExpanded:d,tabIndex:p,toggleGroup:C})},c.key)}const ze=h.memo(Ae),Te="g1yxluv3",Me=`rdg-group-row ${Te}`;function Le({className:s,row:t,rowIdx:i,viewportColumns:d,selectedCellIdx:y,isRowSelected:c,selectCell:R,gridRowStart:b,groupBy:x,toggleGroup:v,isRowSelectionDisabled:m,...p}){const k=d[0].key===U?t.level+1:t.level;function C(){R({rowIdx:i,idx:-1},{shouldFocusCell:!0})}const D=h.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:c}),[c]);return f.jsx(he,{value:D,children:f.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:me(Ce,Me,`rdg-row-${i%2===0?"even":"odd"}`,y===-1&&ye,s),onMouseDown:C,style:xe(b),...p,children:d.map(I=>f.jsx(ze,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:y===I.idx,column:I,row:t,groupColumnIndex:k,toggleGroup:v,isGroupByColumn:x.includes(I.key)},I.key))})})}const Ne=h.memo(Le);function $e({columns:s,rows:t,rowHeight:i,rowKeyGetter:d,onCellKeyDown:y,onCellCopy:c,onCellPaste:R,onRowsChange:b,selectedRows:x,onSelectedRowsChange:v,renderers:m,groupBy:p,rowGrouper:k,expandedGroupIds:C,onExpandedGroupIdsChange:D,groupIdGetter:I,...A}){const Z=Re(),H=m?.renderRow??Z?.renderRow??Se,P=1+(A.topSummaryRows?.length??0),{leftKey:V,rightKey:K}=ke(A.direction),ee=Ge(J),Y=I??We,{columns:ne,groupBy:M}=h.useMemo(()=>{const e=s.toSorted(({key:r},{key:o})=>r===U?-1:o===U?1:p.includes(r)?p.includes(o)?p.indexOf(r)-p.indexOf(o):-1:p.includes(o)?1:0),n=[];for(const[r,o]of e.entries())p.includes(o.key)&&(n.push(o.key),e[r]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??we,editable:!1});return{columns:e,groupBy:n}},[s,p]),[_,te]=h.useMemo(()=>{if(M.length===0)return[void 0,t.length];const e=(n,[r,...o],l)=>{let a=0;const u={};for(const[G,j]of Object.entries(k(n,r))){const[z,E]=o.length===0?[j,j.length]:e(j,o,l+a+1);u[G]={childRows:j,childGroups:z,startRowIndex:l+a},a+=E+1}return[u,a]};return e(t,M,0)},[M,k,t]),[S,g]=h.useMemo(()=>{const e=new Set;if(!_)return[t,o];const n=[],r=(l,a,u)=>{if(_e(l)){n.push(...l);return}Object.keys(l).forEach((G,j,z)=>{const E=Y(G,a),O=C.has(E),{childRows:N,childGroups:$,startRowIndex:T}=l[G],W={id:E,parentId:a,groupKey:G,isExpanded:O,childRows:N,level:u,posInSet:j,startRowIndex:T,setSize:z.length};n.push(W),e.add(W),O&&r($,E,u+1)})};return r(_,void 0,0),[n,o];function o(l){return e.has(l)}},[C,_,t,Y]),oe=h.useMemo(()=>typeof i=="function"?e=>g(e)?i({type:"GROUP",row:e}):i({type:"ROW",row:e}):i,[g,i]),L=h.useCallback(e=>{const n=S.indexOf(e);for(let r=n-1;r>=0;r--){const o=S[r];if(g(o)&&(!g(e)||e.parentId===o.id))return[o,r]}},[g,S]),q=h.useCallback(e=>{if(g(e))return e.id;if(typeof d=="function")return d(e);const n=L(e);if(n!==void 0){const{startRowIndex:r,childRows:o}=n[0],l=o.indexOf(e);return r+l+1}return S.indexOf(e)},[L,g,d,S]),B=h.useMemo(()=>{if(x==null)return null;Q(d);const e=new Set(x);for(const n of S)g(n)&&n.childRows.every(o=>x.has(d(o)))&&e.add(n.id);return e},[g,d,x,S]);function se(e){if(!v)return;Q(d);const n=new Set(x);for(const r of S){const o=q(r);if(B?.has(o)&&!e.has(o))if(g(r))for(const l of r.childRows)n.delete(d(l));else n.delete(o);else if(!B?.has(o)&&e.has(o))if(g(r))for(const l of r.childRows)n.add(d(l));else n.add(o)}v(n)}function re(e,n){if(y?.(e,n),n.isGridDefaultPrevented()||e.mode==="EDIT")return;const{column:r,rowIdx:o,selectCell:l}=e,a=r?.idx??-1,u=S[o];if(g(u)&&(a===-1&&(n.key===V&&u.isExpanded||n.key===K&&!u.isExpanded)&&(n.preventDefault(),n.preventGridDefault(),J(u.id)),a===-1&&n.key===V&&!u.isExpanded&&u.level!==0)){const G=L(u);G!==void 0&&(n.preventGridDefault(),l({idx:a,rowIdx:G[1]}))}}function ie({row:e,column:n},r){g(e)||c?.({row:e,column:n},r)}function le({row:e,column:n},r){return g(e)?e:R({row:e,column:n},r)}function de(e,{indexes:n,column:r}){if(!b)return;const o=[...t],l=[];for(const a of n){const u=t.indexOf(S[a]);o[u]=e[a],l.push(u)}b(o,{indexes:l,column:r})}function J(e){const n=new Set(C);n.has(e)?n.delete(e):n.add(e),D(n)}function ce(e,{row:n,rowClass:r,onCellMouseDown:o,onCellClick:l,onCellDoubleClick:a,onCellContextMenu:u,onRowChange:G,lastFrozenColumnIndex:j,draggedOverCellIdx:z,selectedCellEditor:E,...O}){if(g(n)){const{startRowIndex:T}=n;return f.jsx(Ne,{...O,"aria-rowindex":P+T+1,row:n,groupBy:M,toggleGroup:ee},e)}let N=O["aria-rowindex"];const $=L(n);if($!==void 0){const{startRowIndex:T,childRows:W}=$[0],ue=W.indexOf(n);N=T+P+ue+2}return H(e,{...O,"aria-rowindex":N,row:n,rowClass:r,onCellMouseDown:o,onCellClick:l,onCellDoubleClick:a,onCellContextMenu:u,onRowChange:G,lastFrozenColumnIndex:j,draggedOverCellIdx:z,selectedCellEditor:E})}return f.jsx(be,{...A,role:"treegrid","aria-rowcount":te+1+(A.topSummaryRows?.length??0)+(A.bottomSummaryRows?.length??0),columns:ne,rows:S,rowHeight:oe,rowKeyGetter:q,onRowsChange:de,selectedRows:B,onSelectedRowsChange:se,onCellKeyDown:re,onCellCopy:ie,onCellPaste:R?le:void 0,renderers:{...m,renderRow:ce}})}function We(s,t){return t!==void 0?`${t}__${s}`:s}function _e(s){return Array.isArray(s)}const Be="g8apzrt",Fe="o12aimxb",X=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],Ue=[ve,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:s}){return s.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:s}){return s.gold+s.silver+s.bronze},renderGroupCell({childRows:s}){return s.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function Pe(s){return s.id}function Ve(){const s=[];for(let t=1;t<1e4;t++)s.push({id:t,year:2015+w.number.int(3),country:w.location.country(),sport:X[w.number.int(X.length-1)],athlete:w.person.fullName(),gold:w.number.int(5),silver:w.number.int(5),bronze:w.number.int(5)});return s.sort((t,i)=>i.country.localeCompare(t.country))}const F=["country","year","sport","athlete"];function Ye(s,t){return Object.groupBy(s,i=>i[t])}const Qe=function(){const t=ae(),[i]=h.useState(Ve),[d,y]=h.useState(()=>new Set),[c,R]=h.useState([F[0],F[1]]),[b,x]=h.useState(()=>new Set(["United States of America","United States of America__2015"]));function v(m,p){const k=c.indexOf(m);p?k===-1&&R(C=>[...C,m]):k!==-1&&R(C=>C.toSpliced(k,1)),x(new Set)}return f.jsxs("div",{className:Be,children:[f.jsx("b",{children:"Group by columns:"}),f.jsx("div",{className:Fe,children:F.map(m=>f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:c.includes(m),onChange:p=>v(m,p.target.checked)})," ",m]},m))}),f.jsx($e,{columns:Ue,rows:i,rowKeyGetter:Pe,selectedRows:d,onSelectedRowsChange:y,groupBy:c,rowGrouper:Ye,expandedGroupIds:b,onExpandedGroupIdsChange:x,defaultColumnOptions:{resizable:!0},direction:t})]})};export{Qe as component};
//# sourceMappingURL=RowGrouping-bVBVL7ZO.js.map
