import{j as f,r as h,u as le,f as D}from"./index-B2zJqY8g.js";import{u as de,g as ce,a as ue,S as U,b as ae,d as fe,c as pe,r as ge,e as he,f as xe,h as me,i as ye,j as P,D as Ce,k as Re,l as Se}from"./DataGrid-Dsd-1Iip.js";const ke="g1s9ylgp",be=`rdg-group-cell-content ${ke}`,Ge="cz54e4y",we=`rdg-caret ${Ge}`;function ve(s){return f.jsx(je,{...s})}function je({groupKey:s,isExpanded:t,tabIndex:i,toggleGroup:c}){function C({key:p}){p==="Enter"&&c()}const d=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return f.jsxs("span",{className:be,tabIndex:i,onKeyDown:C,children:[s,f.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:we,"aria-hidden":!0,children:f.jsx("path",{d})})]})}function Ie({id:s,groupKey:t,childRows:i,isExpanded:c,isCellSelected:C,column:d,row:p,groupColumnIndex:v,isGroupByColumn:b,toggleGroup:x}){const{tabIndex:m,childTabIndex:R,onFocus:w}=de(C);function g(){x(s)}const G=b&&v===d.idx;return f.jsx("div",{role:"gridcell","aria-colindex":d.idx+1,"aria-selected":C,tabIndex:m,className:ue(d),style:{...ce(d),cursor:G?"pointer":"default"},onClick:G?g:void 0,onFocus:w,children:(!b||G)&&d.renderGroupCell?.({groupKey:t,childRows:i,column:d,row:p,isExpanded:c,tabIndex:R,toggleGroup:g})},d.key)}const De=h.memo(Ie),Ee="g1yxluv3",Ae=`rdg-group-row ${Ee}`;function Oe({className:s,row:t,rowIdx:i,viewportColumns:c,selectedCellIdx:C,isRowSelected:d,selectCell:p,gridRowStart:v,groupBy:b,toggleGroup:x,isRowSelectionDisabled:m,...R}){const w=c[0].key===U?t.level+1:t.level;function g(){p({rowIdx:i,idx:-1})}const G=h.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:d}),[d]);return f.jsx(ae,{value:G,children:f.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:pe(ge,Ae,`rdg-row-${i%2===0?"even":"odd"}`,C===-1&&he,s),onClick:g,style:fe(v),...R,children:c.map(E=>f.jsx(De,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:C===E.idx,column:E,row:t,groupColumnIndex:w,toggleGroup:x,isGroupByColumn:b.includes(E.key)},E.key))})})}const ze=h.memo(Oe);function Te({columns:s,rows:t,rowHeight:i,rowKeyGetter:c,onCellKeyDown:C,onRowsChange:d,selectedRows:p,onSelectedRowsChange:v,renderers:b,groupBy:x,rowGrouper:m,expandedGroupIds:R,onExpandedGroupIdsChange:w,...g}){const G=xe(),E=b?.renderRow??G?.renderRow??me,F=1+(g.topSummaryRows?.length??0),V=g.direction==="rtl",Y=V?"ArrowRight":"ArrowLeft",X=V?"ArrowLeft":"ArrowRight",Z=ye(J),{columns:H,groupBy:T}=h.useMemo(()=>{const n=[...s].sort(({key:r},{key:o})=>r===U?-1:o===U?1:x.includes(r)?x.includes(o)?x.indexOf(r)-x.indexOf(o):-1:x.includes(o)?1:0),e=[];for(const[r,o]of n.entries())x.includes(o.key)&&(e.push(o.key),n[r]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??ve,editable:!1});return{columns:n,groupBy:e}},[s,x]),[W,K]=h.useMemo(()=>{if(T.length===0)return[void 0,t.length];const n=(e,[r,...o],l)=>{let a=0;const u={};for(const[k,j]of Object.entries(m(e,r))){const[O,I]=o.length===0?[j,j.length]:n(j,o,l+a+1);u[k]={childRows:j,childGroups:O,startRowIndex:l+a},a+=I+1}return[u,a]};return n(t,T,0)},[T,m,t]),[S,y]=h.useMemo(()=>{const n=new Set;if(!W)return[t,o];const e=[],r=(l,a,u)=>{if(Le(l)){e.push(...l);return}Object.keys(l).forEach((k,j,O)=>{const I=a!==void 0?`${a}__${k}`:k,M=R.has(I),{childRows:z,childGroups:N,startRowIndex:$}=l[k],A={id:I,parentId:a,groupKey:k,isExpanded:M,childRows:z,level:u,posInSet:j,startRowIndex:$,setSize:O.length};e.push(A),n.add(A),M&&r(N,I,u+1)})};return r(W,void 0,0),[e,o];function o(l){return n.has(l)}},[R,W,t]),ee=h.useMemo(()=>typeof i=="function"?n=>y(n)?i({type:"GROUP",row:n}):i({type:"ROW",row:n}):i,[y,i]),L=h.useCallback(n=>{const e=S.indexOf(n);for(let r=e-1;r>=0;r--){const o=S[r];if(y(o)&&(!y(n)||n.parentId===o.id))return[o,r]}},[y,S]),q=h.useCallback(n=>{if(y(n))return n.id;if(typeof c=="function")return c(n);const e=L(n);if(e!==void 0){const{startRowIndex:r,childRows:o}=e[0],l=o.indexOf(n);return r+l+1}return S.indexOf(n)},[L,y,c,S]),_=h.useMemo(()=>{if(p==null)return null;P(c);const n=new Set(p);for(const e of S)y(e)&&e.childRows.every(o=>p.has(c(o)))&&n.add(e.id);return n},[y,c,p,S]);function ne(n){if(!v)return;P(c);const e=new Set(p);for(const r of S){const o=q(r);if(_?.has(o)&&!n.has(o))if(y(r))for(const l of r.childRows)e.delete(c(l));else e.delete(o);else if(!_?.has(o)&&n.has(o))if(y(r))for(const l of r.childRows)e.add(c(l));else e.add(o)}v(e)}function te(n,e){if(C?.(n,e),e.isGridDefaultPrevented()||n.mode==="EDIT")return;const{column:r,rowIdx:o,selectCell:l}=n,a=r?.idx??-1,u=S[o];if(y(u)){if(a===-1&&(e.key===Y&&u.isExpanded||e.key===X&&!u.isExpanded)&&(e.preventDefault(),e.preventGridDefault(),J(u.id)),a===-1&&e.key===Y&&!u.isExpanded&&u.level!==0){const k=L(u);k!==void 0&&(e.preventGridDefault(),l({idx:a,rowIdx:k[1]}))}Re(e)&&(e.keyCode===67||e.keyCode===86)&&e.preventGridDefault()}}function oe(n,{indexes:e,column:r}){if(!d)return;const o=[...t],l=[];for(const a of e){const u=t.indexOf(S[a]);o[u]=n[a],l.push(u)}d(o,{indexes:l,column:r})}function J(n){const e=new Set(R);e.has(n)?e.delete(n):e.add(n),w(e)}function se(n,{row:e,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,copiedCellIdx:j,draggedOverCellIdx:O,setDraggedOverRowIdx:I,selectedCellEditor:M,...z}){if(y(e)){const{startRowIndex:A}=e;return f.jsx(ze,{...z,"aria-rowindex":F+A+1,row:e,groupBy:T,toggleGroup:Z},n)}let N=z["aria-rowindex"];const $=L(e);if($!==void 0){const{startRowIndex:A,childRows:re}=$[0],ie=re.indexOf(e);N=A+F+ie+2}return E(n,{...z,"aria-rowindex":N,row:e,rowClass:r,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,copiedCellIdx:j,draggedOverCellIdx:O,setDraggedOverRowIdx:I,selectedCellEditor:M})}return f.jsx(Ce,{...g,role:"treegrid","aria-rowcount":K+1+(g.topSummaryRows?.length??0)+(g.bottomSummaryRows?.length??0),columns:H,rows:S,rowHeight:ee,rowKeyGetter:q,onRowsChange:oe,selectedRows:_,onSelectedRowsChange:ne,onCellKeyDown:te,renderers:{...b,renderRow:se}})}function Le(s){return Array.isArray(s)}const Me="g8apzrt",Ne="o12aimxb",Q=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],$e=[Se,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:s}){return s.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:s}){return s.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:s}){return s.gold+s.silver+s.bronze},renderGroupCell({childRows:s}){return s.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function We(s){return s.id}function _e(){const s=[];for(let t=1;t<1e4;t++)s.push({id:t,year:2015+D.number.int(3),country:D.location.country(),sport:Q[D.number.int(Q.length-1)],athlete:D.person.fullName(),gold:D.number.int(5),silver:D.number.int(5),bronze:D.number.int(5)});return s.sort((t,i)=>i.country.localeCompare(t.country))}const B=["country","year","sport","athlete"];function Be(s,t){return Object.groupBy(s,i=>i[t])}const Ve=function(){const t=le(),[i]=h.useState(_e),[c,C]=h.useState(()=>new Set),[d,p]=h.useState([B[0],B[1]]),[v,b]=h.useState(()=>new Set(["United States of America","United States of America__2015"]));function x(m,R){const w=d.indexOf(m);R?w===-1&&p(g=>[...g,m]):w!==-1&&p(g=>{const G=[...g];return G.splice(w,1),G}),b(new Set)}return f.jsxs("div",{className:Me,children:[f.jsx("b",{children:"Group by columns:"}),f.jsx("div",{className:Ne,children:B.map(m=>f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:d.includes(m),onChange:R=>x(m,R.target.checked)})," ",m]},m))}),f.jsx(Te,{columns:$e,rows:i,rowKeyGetter:We,selectedRows:c,onSelectedRowsChange:C,groupBy:d,rowGrouper:Be,expandedGroupIds:v,onExpandedGroupIdsChange:b,defaultColumnOptions:{resizable:!0},direction:t})]})};export{Ve as component};
//# sourceMappingURL=RowGrouping-DmviQNf6.js.map
