{"version":3,"file":"RowsReordering-ZgbPv5C0.js","names":["useCallback","useState","DataGrid","renderTextEditor","DraggableRowRenderer","startViewTransition","useDirection","Row","id","task","complete","priority","issueType","createRows","rows","i","push","Math","min","round","random","columns","Column","key","name","width","renderEditCell","RowsReordering","direction","setRows","renderRow","React","Key","props","RenderRowProps","onRowReorder","fromIndex","toIndex","reorderRows","row","newRows","toSpliced","splice","component"],"sources":["../../website/components/DraggableRowRenderer.tsx","../../website/routes/RowsReordering.tsx?tsr-split=component"],"sourcesContent":["import { useState } from 'react';\nimport { css } from 'ecij';\nimport clsx from 'clsx';\n\nimport { Row, type RenderRowProps } from '../../src';\n\nconst rowDraggingClassname = css`\n  opacity: 0.5;\n`;\n\nconst rowOverClassname = css`\n  background-color: #ececec;\n`;\n\ninterface DraggableRowRenderProps<R, SR> extends RenderRowProps<R, SR> {\n  onRowReorder: (sourceIndex: number, targetIndex: number) => void;\n}\n\nexport function DraggableRowRenderer<R, SR>({\n  rowIdx,\n  className,\n  onRowReorder,\n  ...props\n}: DraggableRowRenderProps<R, SR>) {\n  const [isDragging, setIsDragging] = useState(false);\n  const [isOver, setIsOver] = useState(false);\n\n  className = clsx(className, {\n    [rowDraggingClassname]: isDragging,\n    [rowOverClassname]: isOver\n  });\n\n  function onDragStart(event: React.DragEvent<HTMLDivElement>) {\n    setIsDragging(true);\n    event.dataTransfer.setData('text/plain', String(rowIdx));\n    event.dataTransfer.dropEffect = 'move';\n  }\n\n  function onDragEnd() {\n    setIsDragging(false);\n  }\n\n  function onDragOver(event: React.DragEvent<HTMLDivElement>) {\n    // prevent default to allow drop\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n  }\n\n  function onDrop(event: React.DragEvent<HTMLDivElement>) {\n    setIsOver(false);\n    // prevent the browser from redirecting in some cases\n    event.preventDefault();\n    onRowReorder(Number(event.dataTransfer.getData('text/plain')), rowIdx);\n  }\n\n  function onDragEnter(event: React.DragEvent<HTMLDivElement>) {\n    if (isEventPertinent(event)) {\n      setIsOver(true);\n    }\n  }\n\n  function onDragLeave(event: React.DragEvent<HTMLDivElement>) {\n    if (isEventPertinent(event)) {\n      setIsOver(false);\n    }\n  }\n\n  return (\n    <Row\n      draggable\n      onDragStart={onDragStart}\n      onDragEnd={onDragEnd}\n      onDragOver={onDragOver}\n      onDragEnter={onDragEnter}\n      onDragLeave={onDragLeave}\n      onDrop={onDrop}\n      rowIdx={rowIdx}\n      className={className}\n      {...props}\n    />\n  );\n}\n\n// only accept pertinent drag events:\n// - ignore drag events going from the container to an element inside the container\n// - ignore drag events going from an element inside the container to the container\nfunction isEventPertinent(event: React.DragEvent) {\n  const relatedTarget = event.relatedTarget as HTMLElement | null;\n\n  return !event.currentTarget.contains(relatedTarget);\n}\n","import { useCallback, useState } from 'react';\n\nimport { DataGrid, renderTextEditor, type Column, type RenderRowProps } from '../../src';\nimport { DraggableRowRenderer } from '../components';\nimport { startViewTransition } from '../utils';\nimport { useDirection } from '../directionContext';\n\nexport const Route = createFileRoute({\n  component: RowsReordering\n});\n\ninterface Row {\n  id: number;\n  task: string;\n  complete: number;\n  priority: string;\n  issueType: string;\n}\n\nfunction createRows(): readonly Row[] {\n  const rows: Row[] = [];\n\n  for (let i = 1; i < 500; i++) {\n    rows.push({\n      id: i,\n      task: `Task ${i}`,\n      complete: Math.min(100, Math.round(Math.random() * 110)),\n      priority: ['Critical', 'High', 'Medium', 'Low'][Math.round(Math.random() * 3)],\n      issueType: ['Bug', 'Improvement', 'Epic', 'Story'][Math.round(Math.random() * 3)]\n    });\n  }\n\n  return rows;\n}\n\nconst columns: readonly Column<Row>[] = [\n  {\n    key: 'id',\n    name: 'ID',\n    width: 80\n  },\n  {\n    key: 'task',\n    name: 'Title',\n    renderEditCell: renderTextEditor\n  },\n  {\n    key: 'priority',\n    name: 'Priority'\n  },\n  {\n    key: 'issueType',\n    name: 'Issue Type'\n  },\n  {\n    key: 'complete',\n    name: '% Complete'\n  }\n];\n\nfunction RowsReordering() {\n  const direction = useDirection();\n  const [rows, setRows] = useState(createRows);\n\n  const renderRow = useCallback((key: React.Key, props: RenderRowProps<Row>) => {\n    function onRowReorder(fromIndex: number, toIndex: number) {\n      function reorderRows() {\n        setRows((rows) => {\n          const row = rows[fromIndex];\n          const newRows = rows.toSpliced(fromIndex, 1);\n          newRows.splice(toIndex, 0, row);\n          return newRows;\n        });\n      }\n\n      startViewTransition(reorderRows);\n    }\n\n    return <DraggableRowRenderer<Row, unknown> key={key} {...props} onRowReorder={onRowReorder} />;\n  }, []);\n\n  return (\n    <DataGrid\n      aria-label=\"Rows Reordering Example\"\n      columns={columns}\n      rows={rows}\n      onRowsChange={setRows}\n      renderers={{ renderRow }}\n      direction={direction}\n    />\n  );\n}\n"],"mappings":"0UAUA,SAAM,EAAsB,CAAA,SAAA,YAAA,eAAA,GAAA,GAAA,sDAQ5B,EAAO,EAAS,EAAA,EAMd,GAAmB,GACnB,GAAe,EAEf,CAAA,UACG,EAAA,EAAuB,GACvB,GAAA,CACF,EAAC,aAAA,QAAA,aAAA,OAAA,EAAA,CAAA,CAEF,EAAA,aAAS,WAAoD,OAE3D,SAAM,GAAa,CACnB,EAAM,GAAa,CAGrB,SAAS,EAAA,EAAY,CACnB,EAAA,gBAAoB,kCAKpB,SAAM,EAAA,EAAgB,CACtB,EAAM,GAAA,oBAGR,EAAS,OAAO,EAAwC,aAAA,QAAA,aAAA,CAAA,CAAA,EAAA,CAGtD,SAAM,EAAA,EAAgB,CACtB,EAAoB,EAAM,EAAA,EAAA,GAAA,CAKxB,SAAA,EAAe,EAAA,aAMf,OAAgB,EAAA,EAAA,KAAA,EAAA,4BAIpB,YAEI,aACa,cACF,cACC,SACC,SACA,YACL,GAAA,EACA,CAAA,UAEJ,EAAA,EAAA,KACJ,EAAA,EAAA,iDC5DN,SAASa,GAA6B,CACpC,IAAMC,EAAc,EAAE,CAEtB,IAAK,IAAIC,EAAI,EAAGA,EAAI,IAAKA,IACvBD,EAAKE,KAAK,CACRR,GAAIO,EACJN,KAAM,QAAQM,IACdL,SAAUO,KAAKC,IAAI,IAAKD,KAAKE,MAAMF,KAAKG,QAAQ,CAAG,IAAI,CAAC,CACxDT,SAAU,CAAC,WAAY,OAAQ,SAAU,MAAM,CAACM,KAAKE,MAAMF,KAAKG,QAAQ,CAAG,EAAE,EAC7ER,UAAW,CAAC,MAAO,cAAe,OAAQ,QAAQ,CAACK,KAAKE,MAAMF,KAAKG,QAAQ,CAAG,EAAE,EACjF,CAAC,CAGJ,OAAON,EAGT,IAAMO,EAAkC,CACtC,CACEE,IAAK,KACLC,KAAM,KACNC,MAAO,GACR,CACD,CACEF,IAAK,OACLC,KAAM,QACNE,eAAgBvB,EACjB,CACD,CACEoB,IAAK,WACLC,KAAM,WACP,CACD,CACED,IAAK,YACLC,KAAM,aACP,CACD,CACED,IAAK,WACLC,KAAM,aACP,CACF,CAED,SAASG,GAAiB,CACxB,IAAMC,EAAYtB,GAAc,CAC1B,CAACQ,EAAMe,IAAAA,EAAAA,EAAAA,UAAoBhB,EAAW,CAEtCiB,GAAAA,EAAAA,EAAAA,cAAyBP,EAAgBU,IAA+B,CAC5E,SAASE,EAAaC,EAAmBC,EAAiB,CACxD,SAASC,GAAc,CACrBT,EAASf,GAAS,CAChB,IAAMyB,EAAMzB,EAAKsB,GACXI,EAAU1B,EAAK2B,UAAUL,EAAW,EAAE,CAE5C,OADAI,EAAQE,OAAOL,EAAS,EAAGE,EAAI,CACxBC,GACP,CAGJnC,EAAoBiC,EAAY,CAGlC,OAAO,EAAA,EAAA,KAAC,EAAD,CAA8C,GAAIL,EAAqBE,eAAgB,CAA9CZ,EAA8C,EAC7F,EAAE,CAAC,CAEN,OACE,EAAA,EAAA,KAAC,EAAD,CACE,aAAW,0BACFF,UACHP,OACN,aAAce,EACd,UAAW,CAAEC,YAAW,CACbF,YACX,CAAA"}