import{j as f,r as h,u as ue,f as A}from"./index-Dx6kd565.js";import{u as ae,g as fe,a as pe,S as U,b as ge,d as he,c as xe,r as me,e as Ce,f as ye,h as Re,i as Se,j as J,D as ke,k as be}from"./DataGrid-COQcQMgt.js";const Ge="g1s9ylgp",ve=`rdg-group-cell-content ${Ge}`,je="cz54e4y",Ie=`rdg-caret ${je}`;function we(r){return f.jsx(Ee,{...r})}function Ee({groupKey:r,isExpanded:t,tabIndex:i,toggleGroup:d}){function y({key:R}){R==="Enter"&&d()}const c=t?"M1 1 L 7 7 L 13 1":"M1 7 L 7 1 L 13 7";return f.jsxs("span",{className:ve,tabIndex:i,onKeyDown:y,children:[r,f.jsx("svg",{viewBox:"0 0 14 8",width:"14",height:"8",className:Ie,"aria-hidden":!0,children:f.jsx("path",{d:c})})]})}function Ae({id:r,groupKey:t,childRows:i,isExpanded:d,isCellSelected:y,column:c,row:R,groupColumnIndex:j,isGroupByColumn:x,toggleGroup:I}){const{tabIndex:m,childTabIndex:p,onFocus:b}=ae(y);function C(){I(r)}const G=x&&j===c.idx;return f.jsx("div",{role:"gridcell","aria-colindex":c.idx+1,"aria-selected":y,tabIndex:m,className:pe(c),style:{...fe(c),cursor:G?"pointer":"default"},onClick:G?C:void 0,onFocus:b,children:(!x||G)&&c.renderGroupCell?.({groupKey:t,childRows:i,column:c,row:R,isExpanded:d,tabIndex:p,toggleGroup:C})},c.key)}const De=h.memo(Ae),Oe="g1yxluv3",ze=`rdg-group-row ${Oe}`;function Te({className:r,row:t,rowIdx:i,viewportColumns:d,selectedCellIdx:y,isRowSelected:c,selectCell:R,gridRowStart:j,groupBy:x,toggleGroup:I,isRowSelectionDisabled:m,...p}){const b=d[0].key===U?t.level+1:t.level;function C(){R({rowIdx:i,idx:-1})}const G=h.useMemo(()=>({isRowSelectionDisabled:!1,isRowSelected:c}),[c]);return f.jsx(ge,{value:G,children:f.jsx("div",{role:"row","aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:xe(me,ze,`rdg-row-${i%2===0?"even":"odd"}`,y===-1&&Ce,r),onClick:C,style:he(j),...p,children:d.map(v=>f.jsx(De,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:y===v.idx,column:v,row:t,groupColumnIndex:b,toggleGroup:I,isGroupByColumn:x.includes(v.key)},v.key))})})}const Le=h.memo(Te);function Me({columns:r,rows:t,rowHeight:i,rowKeyGetter:d,onCellKeyDown:y,onCellCopy:c,onCellPaste:R,onRowsChange:j,selectedRows:x,onSelectedRowsChange:I,renderers:m,groupBy:p,rowGrouper:b,expandedGroupIds:C,onExpandedGroupIdsChange:G,...v}){const X=ye(),Z=m?.renderRow??X?.renderRow??Re,F=1+(v.topSummaryRows?.length??0),P=v.direction==="rtl",V=P?"ArrowRight":"ArrowLeft",H=P?"ArrowLeft":"ArrowRight",K=Se(q),{columns:ee,groupBy:T}=h.useMemo(()=>{const e=[...r].sort(({key:s},{key:o})=>s===U?-1:o===U?1:p.includes(s)?p.includes(o)?p.indexOf(s)-p.indexOf(o):-1:p.includes(o)?1:0),n=[];for(const[s,o]of e.entries())p.includes(o.key)&&(n.push(o.key),e[s]={...o,frozen:!0,renderCell:()=>null,renderGroupCell:o.renderGroupCell??we,editable:!1});return{columns:e,groupBy:n}},[r,p]),[W,ne]=h.useMemo(()=>{if(T.length===0)return[void 0,t.length];const e=(n,[s,...o],l)=>{let a=0;const u={};for(const[k,w]of Object.entries(b(n,s))){const[O,E]=o.length===0?[w,w.length]:e(w,o,l+a+1);u[k]={childRows:w,childGroups:O,startRowIndex:l+a},a+=E+1}return[u,a]};return e(t,T,0)},[T,b,t]),[S,g]=h.useMemo(()=>{const e=new Set;if(!W)return[t,o];const n=[],s=(l,a,u)=>{if(Ne(l)){n.push(...l);return}Object.keys(l).forEach((k,w,O)=>{const E=a!==void 0?`${a}__${k}`:k,D=C.has(E),{childRows:M,childGroups:N,startRowIndex:z}=l[k],$={id:E,parentId:a,groupKey:k,isExpanded:D,childRows:M,level:u,posInSet:w,startRowIndex:z,setSize:O.length};n.push($),e.add($),D&&s(N,E,u+1)})};return s(W,void 0,0),[n,o];function o(l){return e.has(l)}},[C,W,t]),te=h.useMemo(()=>typeof i=="function"?e=>g(e)?i({type:"GROUP",row:e}):i({type:"ROW",row:e}):i,[g,i]),L=h.useCallback(e=>{const n=S.indexOf(e);for(let s=n-1;s>=0;s--){const o=S[s];if(g(o)&&(!g(e)||e.parentId===o.id))return[o,s]}},[g,S]),Y=h.useCallback(e=>{if(g(e))return e.id;if(typeof d=="function")return d(e);const n=L(e);if(n!==void 0){const{startRowIndex:s,childRows:o}=n[0],l=o.indexOf(e);return s+l+1}return S.indexOf(e)},[L,g,d,S]),_=h.useMemo(()=>{if(x==null)return null;J(d);const e=new Set(x);for(const n of S)g(n)&&n.childRows.every(o=>x.has(d(o)))&&e.add(n.id);return e},[g,d,x,S]);function oe(e){if(!I)return;J(d);const n=new Set(x);for(const s of S){const o=Y(s);if(_?.has(o)&&!e.has(o))if(g(s))for(const l of s.childRows)n.delete(d(l));else n.delete(o);else if(!_?.has(o)&&e.has(o))if(g(s))for(const l of s.childRows)n.add(d(l));else n.add(o)}I(n)}function se(e,n){if(y?.(e,n),n.isGridDefaultPrevented()||e.mode==="EDIT")return;const{column:s,rowIdx:o,selectCell:l}=e,a=s?.idx??-1,u=S[o];if(g(u)&&(a===-1&&(n.key===V&&u.isExpanded||n.key===H&&!u.isExpanded)&&(n.preventDefault(),n.preventGridDefault(),q(u.id)),a===-1&&n.key===V&&!u.isExpanded&&u.level!==0)){const k=L(u);k!==void 0&&(n.preventGridDefault(),l({idx:a,rowIdx:k[1]}))}}function re({row:e,column:n},s){g(e)||c?.({row:e,column:n},s)}function ie({row:e,column:n},s){return g(e)?e:R({row:e,column:n},s)}function le(e,{indexes:n,column:s}){if(!j)return;const o=[...t],l=[];for(const a of n){const u=t.indexOf(S[a]);o[u]=e[a],l.push(u)}j(o,{indexes:l,column:s})}function q(e){const n=new Set(C);n.has(e)?n.delete(e):n.add(e),G(n)}function de(e,{row:n,rowClass:s,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,draggedOverCellIdx:w,setDraggedOverRowIdx:O,selectedCellEditor:E,...D}){if(g(n)){const{startRowIndex:z}=n;return f.jsx(Le,{...D,"aria-rowindex":F+z+1,row:n,groupBy:T,toggleGroup:K},e)}let M=D["aria-rowindex"];const N=L(n);if(N!==void 0){const{startRowIndex:z,childRows:$}=N[0],ce=$.indexOf(n);M=z+F+ce+2}return Z(e,{...D,"aria-rowindex":M,row:n,rowClass:s,onCellClick:o,onCellDoubleClick:l,onCellContextMenu:a,onRowChange:u,lastFrozenColumnIndex:k,draggedOverCellIdx:w,setDraggedOverRowIdx:O,selectedCellEditor:E})}return f.jsx(ke,{...v,role:"treegrid","aria-rowcount":ne+1+(v.topSummaryRows?.length??0)+(v.bottomSummaryRows?.length??0),columns:ee,rows:S,rowHeight:te,rowKeyGetter:Y,onRowsChange:le,selectedRows:_,onSelectedRowsChange:oe,onCellKeyDown:se,onCellCopy:re,onCellPaste:R?ie:void 0,renderers:{...m,renderRow:de}})}function Ne(r){return Array.isArray(r)}const $e="g8apzrt",We="o12aimxb",Q=["Swimming","Gymnastics","Speed Skating","Cross Country Skiing","Short-Track Speed Skating","Diving","Cycling","Biathlon","Alpine Skiing","Ski Jumping","Nordic Combined","Athletics","Table Tennis","Tennis","Synchronized Swimming","Shooting","Rowing","Fencing","Equestrian","Canoeing","Bobsleigh","Badminton","Archery","Wrestling","Weightlifting","Waterpolo","Wrestling","Weightlifting"],_e=[be,{key:"country",name:"Country"},{key:"year",name:"Year"},{key:"sport",name:"Sport"},{key:"athlete",name:"Athlete"},{key:"gold",name:"Gold",renderGroupCell({childRows:r}){return r.reduce((t,{gold:i})=>t+i,0)}},{key:"silver",name:"Silver",renderGroupCell({childRows:r}){return r.reduce((t,{silver:i})=>t+i,0)}},{key:"bronze",name:"Bronze",renderGroupCell({childRows:r}){return r.reduce((t,{silver:i})=>t+i,0)}},{key:"total",name:"Total",renderCell({row:r}){return r.gold+r.silver+r.bronze},renderGroupCell({childRows:r}){return r.reduce((t,i)=>t+i.gold+i.silver+i.bronze,0)}}];function Be(r){return r.id}function Ue(){const r=[];for(let t=1;t<1e4;t++)r.push({id:t,year:2015+A.number.int(3),country:A.location.country(),sport:Q[A.number.int(Q.length-1)],athlete:A.person.fullName(),gold:A.number.int(5),silver:A.number.int(5),bronze:A.number.int(5)});return r.sort((t,i)=>i.country.localeCompare(t.country))}const B=["country","year","sport","athlete"];function Fe(r,t){return Object.groupBy(r,i=>i[t])}const Ye=function(){const t=ue(),[i]=h.useState(Ue),[d,y]=h.useState(()=>new Set),[c,R]=h.useState([B[0],B[1]]),[j,x]=h.useState(()=>new Set(["United States of America","United States of America__2015"]));function I(m,p){const b=c.indexOf(m);p?b===-1&&R(C=>[...C,m]):b!==-1&&R(C=>{const G=[...C];return G.splice(b,1),G}),x(new Set)}return f.jsxs("div",{className:$e,children:[f.jsx("b",{children:"Group by columns:"}),f.jsx("div",{className:We,children:B.map(m=>f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:c.includes(m),onChange:p=>I(m,p.target.checked)})," ",m]},m))}),f.jsx(Me,{columns:_e,rows:i,rowKeyGetter:Be,selectedRows:d,onSelectedRowsChange:y,groupBy:c,rowGrouper:Fe,expandedGroupIds:j,onExpandedGroupIdsChange:x,defaultColumnOptions:{resizable:!0},direction:t})]})};export{Ye as component};
//# sourceMappingURL=RowGrouping-GGKfrN49.js.map
