import{c as e,i as t,j as n,l as r,o as i}from"./index-xES5FvWU.js";import{b as a,d as o,e as s,f as c,h as l,i as u,j as d,k as f,l as p,n as m,o as h,p as g,q as _,r as v,s as y,t as b}from"./DataGrid-Cs2Jr2RL.js";var x=i(n());function S(e){return(0,x.jsx)(C,{...e})}function C({groupKey:e,isExpanded:t,tabIndex:n,toggleGroup:r}){function i({key:e}){e===`Enter`&&r()}let a=t?`M1 1 L 7 7 L 13 1`:`M1 7 L 7 1 L 13 7`;return(0,x.jsxs)(`span`,{className:`rdg-group-cell-content g1s9ylgp`,tabIndex:n,onKeyDown:i,children:[e,(0,x.jsx)(`svg`,{viewBox:`0 0 14 8`,width:`14`,height:`8`,className:`rdg-caret cz54e4y`,"aria-hidden":!0,children:(0,x.jsx)(`path`,{d:a})})]})}var w=i(r());function T({id:e,groupKey:t,childRows:n,isExpanded:r,isCellSelected:i,column:a,row:o,groupColumnIndex:s,isGroupByColumn:c,toggleGroup:u}){let{tabIndex:d,childTabIndex:f,onFocus:p}=l(i);function m(){u(e)}let h=c&&s===a.idx;return(0,x.jsx)(`div`,{role:`gridcell`,"aria-colindex":a.idx+1,"aria-selected":i,tabIndex:d,className:g(a),style:{..._(a),cursor:h?`pointer`:`default`},onMouseDown:e=>{e.preventDefault()},onClick:h?m:void 0,onFocus:p,children:(!c||h)&&a.renderGroupCell?.({groupKey:t,childRows:n,column:a,row:o,isExpanded:r,tabIndex:f,toggleGroup:m})},a.key)}var E=(0,w.memo)(T);function D({className:e,row:t,rowIdx:n,viewportColumns:r,selectedCellIdx:i,isRowSelected:a,selectCell:o,gridRowStart:l,groupBy:u,toggleGroup:f,isRowSelectionDisabled:m,...h}){let g=r[0].key===d?t.level+1:t.level;function _(){o({rowIdx:n,idx:-1},{shouldFocusCell:!0})}let y=(0,w.useMemo)(()=>({isRowSelectionDisabled:!1,isRowSelected:a}),[a]);return(0,x.jsx)(p,{value:y,children:(0,x.jsx)(`div`,{role:`row`,"aria-level":t.level+1,"aria-setsize":t.setSize,"aria-posinset":t.posInSet+1,"aria-expanded":t.isExpanded,className:b(s,`rdg-group-row g1yxluv3`,`rdg-row-${n%2==0?`even`:`odd`}`,i===-1&&c,e),onMouseDown:_,style:v(l),...h,children:r.map(e=>(0,x.jsx)(E,{id:t.id,groupKey:t.groupKey,childRows:t.childRows,isExpanded:t.isExpanded,isCellSelected:i===e.idx,column:e,row:t,groupColumnIndex:g,toggleGroup:f,isGroupByColumn:u.includes(e.key)},e.key))})})}var O=(0,w.memo)(D);function k({columns:e,rows:t,rowHeight:n,rowKeyGetter:r,onCellKeyDown:i,onCellCopy:s,onCellPaste:c,onRowsChange:l,selectedRows:f,onSelectedRowsChange:p,renderers:g,groupBy:_,rowGrouper:v,expandedGroupIds:b,onExpandedGroupIdsChange:C,groupIdGetter:T,...E}){let D=m(),k=g?.renderRow??D?.renderRow??o,M=1+(E.topSummaryRows?.length??0),{leftKey:N,rightKey:P}=y(E.direction),F=u(Q),I=T??A,{columns:L,groupBy:R}=(0,w.useMemo)(()=>{let t=e.toSorted(({key:e},{key:t})=>e===d?-1:t===d?1:_.includes(e)?_.includes(t)?_.indexOf(e)-_.indexOf(t):-1:_.includes(t)?1:0),n=[];for(let[e,r]of t.entries())_.includes(r.key)&&(n.push(r.key),t[e]={...r,frozen:!0,renderCell:()=>null,renderGroupCell:r.renderGroupCell??S,editable:!1});return{columns:t,groupBy:n}},[e,_]),[z,B]=(0,w.useMemo)(()=>{if(R.length===0)return[void 0,t.length];let e=(t,[n,...r],i)=>{let a=0,o={};for(let[s,c]of Object.entries(v(t,n))){let[t,n]=r.length===0?[c,c.length]:e(c,r,i+a+1);o[s]={childRows:c,childGroups:t,startRowIndex:i+a},a+=n+1}return[o,a]};return e(t,R,0)},[R,v,t]),[V,H]=(0,w.useMemo)(()=>{let e=new Set;if(!z)return[t,i];let n=[],r=(t,i,a)=>{if(j(t)){n.push(...t);return}Object.keys(t).forEach((o,s,c)=>{let l=I(o,i),u=b.has(l),{childRows:d,childGroups:f,startRowIndex:p}=t[o],m={id:l,parentId:i,groupKey:o,isExpanded:u,childRows:d,level:a,posInSet:s,startRowIndex:p,setSize:c.length};n.push(m),e.add(m),u&&r(f,l,a+1)})};return r(z,void 0,0),[n,i];function i(t){return e.has(t)}},[b,z,t,I]),U=(0,w.useMemo)(()=>typeof n==`function`?e=>H(e)?n({type:`GROUP`,row:e}):n({type:`ROW`,row:e}):n,[H,n]),W=(0,w.useCallback)(e=>{let t=V.indexOf(e);for(let n=t-1;n>=0;n--){let t=V[n];if(H(t)&&(!H(e)||e.parentId===t.id))return[t,n]}},[H,V]),G=(0,w.useCallback)(e=>{if(H(e))return e.id;if(typeof r==`function`)return r(e);let t=W(e);if(t!==void 0){let{startRowIndex:n,childRows:r}=t[0],i=r.indexOf(e);return n+i+1}return V.indexOf(e)},[W,H,r,V]),K=(0,w.useMemo)(()=>{if(f==null)return null;h(r);let e=new Set(f);for(let t of V)if(H(t)){let n=t.childRows.every(e=>f.has(r(e)));n&&e.add(t.id)}return e},[H,r,f,V]);function q(e){if(!p)return;h(r);let t=new Set(f);for(let n of V){let i=G(n);if(K?.has(i)&&!e.has(i))if(H(n))for(let e of n.childRows)t.delete(r(e));else t.delete(i);else if(!K?.has(i)&&e.has(i))if(H(n))for(let e of n.childRows)t.add(r(e));else t.add(i)}p(t)}function J(e,t){if(i?.(e,t),t.isGridDefaultPrevented()||e.mode===`EDIT`)return;let{column:n,rowIdx:r,selectCell:a}=e,o=n?.idx??-1,s=V[r];if(H(s)&&(o===-1&&(t.key===N&&s.isExpanded||t.key===P&&!s.isExpanded)&&(t.preventDefault(),t.preventGridDefault(),Q(s.id)),o===-1&&t.key===N&&!s.isExpanded&&s.level!==0)){let e=W(s);e!==void 0&&(t.preventGridDefault(),a({idx:o,rowIdx:e[1]}))}}function Y({row:e,column:t},n){H(e)||s?.({row:e,column:t},n)}function X({row:e,column:t},n){return H(e)?e:c({row:e,column:t},n)}function Z(e,{indexes:n,column:r}){if(!l)return;let i=[...t],a=[];for(let r of n){let n=t.indexOf(V[r]);i[n]=e[r],a.push(n)}l(i,{indexes:a,column:r})}function Q(e){let t=new Set(b);t.has(e)?t.delete(e):t.add(e),C(t)}function $(e,{row:t,rowClass:n,onCellMouseDown:r,onCellClick:i,onCellDoubleClick:a,onCellContextMenu:o,onRowChange:s,lastFrozenColumnIndex:c,draggedOverCellIdx:l,selectedCellEditor:u,...d}){if(H(t)){let{startRowIndex:n}=t;return(0,x.jsx)(O,{...d,"aria-rowindex":M+n+1,row:t,groupBy:R,toggleGroup:F},e)}let f=d[`aria-rowindex`],p=W(t);if(p!==void 0){let{startRowIndex:e,childRows:n}=p[0],r=n.indexOf(t);f=e+M+r+2}return k(e,{...d,"aria-rowindex":f,row:t,rowClass:n,onCellMouseDown:r,onCellClick:i,onCellDoubleClick:a,onCellContextMenu:o,onRowChange:s,lastFrozenColumnIndex:c,draggedOverCellIdx:l,selectedCellEditor:u})}return(0,x.jsx)(a,{...E,role:`treegrid`,"aria-rowcount":B+1+(E.topSummaryRows?.length??0)+(E.bottomSummaryRows?.length??0),columns:L,rows:V,rowHeight:U,rowKeyGetter:G,onRowsChange:Z,selectedRows:K,onSelectedRowsChange:q,onCellKeyDown:J,onCellCopy:Y,onCellPaste:c?X:void 0,renderers:{...g,renderRow:$}})}function A(e,t){return t===void 0?e:`${t}__${e}`}function j(e){return Array.isArray(e)}const M=`Swimming.Gymnastics.Speed Skating.Cross Country Skiing.Short-Track Speed Skating.Diving.Cycling.Biathlon.Alpine Skiing.Ski Jumping.Nordic Combined.Athletics.Table Tennis.Tennis.Synchronized Swimming.Shooting.Rowing.Fencing.Equestrian.Canoeing.Bobsleigh.Badminton.Archery.Wrestling.Weightlifting.Waterpolo.Wrestling.Weightlifting`.split(`.`),N=[f,{key:`country`,name:`Country`},{key:`year`,name:`Year`},{key:`sport`,name:`Sport`},{key:`athlete`,name:`Athlete`},{key:`gold`,name:`Gold`,renderGroupCell({childRows:e}){return e.reduce((e,{gold:t})=>e+t,0)}},{key:`silver`,name:`Silver`,renderGroupCell({childRows:e}){return e.reduce((e,{silver:t})=>e+t,0)}},{key:`bronze`,name:`Bronze`,renderGroupCell({childRows:e}){return e.reduce((e,{silver:t})=>e+t,0)}},{key:`total`,name:`Total`,renderCell({row:e}){return e.gold+e.silver+e.bronze},renderGroupCell({childRows:e}){return e.reduce((e,t)=>e+t.gold+t.silver+t.bronze,0)}}];function P(e){return e.id}function F(){let t=[];for(let n=1;n<1e4;n++)t.push({id:n,year:2015+e.number.int(3),country:e.location.country(),sport:M[e.number.int(M.length-1)],athlete:e.person.fullName(),gold:e.number.int(5),silver:e.number.int(5),bronze:e.number.int(5)});return t.sort((e,t)=>t.country.localeCompare(e.country))}const I=[`country`,`year`,`sport`,`athlete`];function L(){let e=t(),[n]=(0,w.useState)(F),[r,i]=(0,w.useState)(()=>new Set),[a,o]=(0,w.useState)([I[0],I[1]]),[s,c]=(0,w.useState)(()=>new Set([`United States of America`,`United States of America__2015`]));function l(e,t){let n=a.indexOf(e);t?n===-1&&o(t=>[...t,e]):n!==-1&&o(e=>e.toSpliced(n,1)),c(new Set)}return(0,x.jsxs)(`div`,{className:`g8apzrt`,children:[(0,x.jsx)(`b`,{children:`Group by columns:`}),(0,x.jsx)(`div`,{className:`o12aimxb`,children:I.map(e=>(0,x.jsxs)(`label`,{children:[(0,x.jsx)(`input`,{type:`checkbox`,checked:a.includes(e),onChange:t=>l(e,t.target.checked)}),` `,e]},e))}),(0,x.jsx)(k,{"aria-label":`Row Grouping Example`,columns:N,rows:n,rowKeyGetter:P,selectedRows:r,onSelectedRowsChange:i,groupBy:a,rowGrouper:R,expandedGroupIds:s,onExpandedGroupIdsChange:c,defaultColumnOptions:{resizable:!0},direction:e})]})}function R(e,t){return Object.groupBy(e,e=>e[t])}export{L as component};
//# sourceMappingURL=RowGrouping-CfYsfn7e.js.map